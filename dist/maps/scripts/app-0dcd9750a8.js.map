{"version":3,"sources":["scripts/app-0dcd9750a8.js"],"names":["angular","module","directive","templateUrl","restrict","link","postLink","scope","element","attrs","isSmall","stream","AccessPoints","_","uniq","isAlertSymbolDisplayed","isRestrictions","Restrictions","length","isMessage","AlertMessage","getAlertMessage","expand","console","log","getCounties","Counties","map","c","Name","join","getAlternativeNames","LocalNames","StreamApiService","getCountyScrollBodyId","county","result","getCountyId","getScrollContainer","id","displayedCounties","init","clearCounties","loadMoreCounties","numberOfCountiesToAdd","numberOfDisplayedCounties","numberOfChildCounties","region","children","numberOfCountiesRemaining","Math","min","finalIndex","i","countyToInject","push","getRegionScrollBodyId","getRegionId","StreamRatioViewModel","model","TroutStreamsLength","PalsLength","streamRatio","stage","isLoaded","streams","selectedStream","$watch","newSelectedStream","oldSelectedStream","controller","$scope","TableOfContentsRepository","RegionGeometryService","$anchorScroll","isSmallView","getInitialMapState","mapState","isExpanded","isLoading","selectedRegionGeometry","selectedRegion","selectedCounty","highlightedStream","currentClientCoordinates","NaN","selectCounty","countyId","selectRegion","regionModel","Error","canRetrieveFromCache","stateModel","parent","getRegion","then","newSelectedRegionGeometry","getTableOfContents","toc","bustCache","bustTableOfContentsCache","toggleMinimap","LinearReferenceViewModel","parseFloat","LengthMiles","inverseLength","width","ANIMATION_SPEED","createTickMarks","clampedLength","floor","tickMarks","xOffset","height","yOffset","tickWidth","drawLines","streamLine","d3","select","append","attr","publicSegments","Pal","Sections","segment","publicLand","selectAll","data","enter","d","transition","delay","lakes","Lakes","firstMark","accessPoints","TroutStreams","troutStreamSections","forEach","restriction","index","restrictionModels","linearReferenceViewModel","roadIntersections","LinearOffset","isUninteresting","IsOverOrNearPublicLand","IsOverOrNearTroutStreamSection","fsm","$rootScope","replace","scrollBody","scrollStop","scrollableContainer","contentOffset","scrollObject","zIndexOverride","attributes","control","header","$","this","getContent","candidateContent","content","clonedHeader","window","setColumnHeaderSizes","is","clonedColumns","find","each","column","clonedColumn","css","offsetWidth","determineVisibility","scrollTop","currentContent","contentTop","offset","top","contentBottom","outerHeight","createClone","visibility","calculateSize","remove","removeClass","position","left","z-index","outerWidth","$broadcast","clone","after","addClass","on","trigger","$on","off","$location","el","navigationMenu","menuTitles","menuItems","activeMenu","menuOnClick","e","menuTitle","currentTarget","submenu","next","slideToggle","chevron","toggleClass","menuOnKeydown","getCurrentMenuItem","keyCode","tabOutOfMenu","triggerMenuItem","highlightMenuItem","shiftKey","focus","firstTabItem","preventDefault","stopPropagation","first","focusedMenu","menuOnFocus","click","keydown","path","allMenuItems","menuItem","menu","split","indexOf","parentElement","submenus","parents","show","chevrons","prev","menuButton","bodyOnKeydown","ctrlKey","altKey","isMenuClosed","hasClass","setMenuSpin","setTimeout","$filter","transclude","orderBy","currentPage","pagedDataName","fsmBigData","rightHandExpression","pageSize","parseInt","sourceData","rawData","sortedData","pagedData","page","sortTypes","sortColumns","transcludedScope","nextPage","dataSlice","slice","apply","renderData","addSortColumn","columnName","sortType","splice","direction","unshift","onPageScroll","s","document","scrollPercent","$apply","$parent","$watchCollection","newData","sortIconTemplate","columnHeader","fsmSort","sortIcon","currentSortType","swapIcons","classToAdd","applySort","cursor","MINI_MAP_CLASS","GeometryApiService","$q","$timeout","minimapState","regionGeometries","selectedRegionId","selectedCountyId","isMacro","loadingRegion","active","event","item","type","name","unwatchRegionId","newRegionId","oldRegionId","soughtRegion","currentRegions","filter","f","zoomToGeometry","unwatchCountyId","newCounty","oldCounty","soughtCounty","currentCounties","unwatchGeometries","newGeometries","oldGeometries","drawGeometries","geometries","root","highlightCounty","zoomToRegion","regionId","initializeMap","stateObject","projection","geo","albersUsa","scale","translate","pointRadius","state","geometry","b","bounds","max","t","zoom","behavior","scaleExtent","size","zoomed","svg","stopped","onBackgroundClick","counties","states","regions","onRegionClick","onLoadRegion","bind","resetLoadRegion","minifyMinimap","macrofyMinimap","isMacroMode","reset","drawGeometryToMap","getFipsCodeSelector","shortName","classed","duration","call","style","regionElement","arrayOfStreams","selectedStreams","unique","flatten","streamObjects","Id","exit","node","dx","dy","x","y","getFipsCode","countyFeature","fips","statefp","countyfp","attribute","defaultPrevented","pluck","value","currentState","minStreamCount","countyStreamCounts","feat","stream_count","maxStreamCount","countyChoroplethScale","linear","domain","range","unwatchTableOfContents","factory","RectangleLayoutService","proto","prototype","getScale","itemLength","sqrt","getXGivenY","getYGivenX","pythagoreanTheorem","getBoundingBox","numberOfItems","minimumXPosition","minimumYPosition","xPrime","ceil","yPrime","newYLength","yZLength","newXLength","xZLength","candidate","ROOT_CLASS","WIDTH","HEIGHT","troutStreamIntersections","sort","a","denominator","publicTroutStreamIntersections","numerator","rows","generator","dimensions","numberOfColumns","numberOfRows","boxWidth","widthOfContainer","heightOfContainer","container","xPosition","yPosition","BaseApiService","HierarchicalGeometryViewModel","TABLE_OF_CONTENTS_CACHE_KEY","COUNTIES_CACHE_KEY","REGIONS_CACHE_KEY","logCache","Object","create","key","cache","get","promise","doCall","regionTopoJson","topojson","feature","objects","streamProperties","stateHash","features","prop","properties","gid","centroidLatitude","short_name","centroidLongitude","indexBy","regionHash","sortBy","countyhash","countyModel","extend","countyByRegion","groupBy","minnesota","regionByState","streamHash","streamModel","CentroidLongitude","CentroidLatitude","stateId","streamCountyModel","put","BaseCollection","HierarchicalGeometryCollection","constructor","RegionRepositoryService","getRegions","isCached","regionid","cacheRegion","uncacheRegion","REGION_CACHE_KEY","createKey","RegionApiService","regionKey","createPath","totalLength","publicLandLength","computeRadiusFromLength","area","PI","waterRadius","publicLandLengthTOWaterLengthRatio","publicLandRadius","$cacheFactory","$http","getStreams","deferred","defer","gettingData","response","resolve","StreamLineViewModel","lineSegment","stop","Stop","start","Start","abs","getRegionGeometries","BaseModel","json","_fromJSON","hasOwnProperty","toJSON","hash","destroy","generateIdomaticName","udefOrArray","_models","_addAll","toArray","copy","arrayOrUndefined","modelData","len","add","instanceModel","modelDataOrId","referenceToModelOrId","_removeByModel","_removeById","empty","sortFn","sortDesc","modelA","modelB","sortByType","sortByString","sortByCount","sortByNumber","useLowercase","toLowerCase","at","getPage","pageNumber","perPage","startIndex","endIndex","contains","merge","otherCollection","self","removed","added","methods","method","args","Array","arguments","SORT","TYPE","ARRAY_LENGTH","STRING","DATE","NUMBER","sessionStorage","DEBUGGER_LATENCY","globalCache","resetCache","removeAll","info","endpoint","config","url","API_BASE_PATH","params","exceptionType","reject","catch","reason","run","runBlock","$log","debug","$inject","routerConfig","$stateProvider","$urlRouterProvider","controllerAs","otherwise","$logProvider","debugEnabled","$templateCache"],"mappings":"CAAA,WACE,YACAA,SAAQC,OAAO,SACfD,SACGC,OAAO,cAAe,YAAa,MAAO,uBAI/C,aAQAD,SAAQC,OAAO,cACZC,UAAU,0BAA2B,WACpC,OACEC,YAAa,+DACbC,SAAU,IACVC,KAAM,QAASC,UAASC,MAAOC,QAASC,OACtCF,MAAMG,QAAU,IAChBH,OAAMI,OAAOC,aAAeC,EAAEC,KAAKP,MAAMI,OAAOC,aAAc,eAC9DL,OAAMQ,uBAAyB,WAC7B,GAAIR,MAAMG,UAAY,MAAO,CAC3B,MAAO,OAGT,GAAIM,gBAAiBT,MAAMI,OAAOM,aAAaC,OAAS,CACxD,IAAIC,WAAYZ,MAAMI,OAAOS,cAAgB,MAAQb,MAAMI,OAAOS,aAAaF,OAAS,CAExF,IAAIF,gBAAkBG,UAAW,CAC/B,MAAO,OAIXZ,OAAMc,gBAAkB,WACtB,MAAOd,OAAMI,OAAOS,aAGtBb,OAAMe,OAAS,WACbf,MAAMG,SAAWH,MAAMG,OACvBa,SAAQC,IAAIjB,MAAMI,QAGpBJ,OAAMkB,YAAc,WAClB,IAAKlB,MAAMI,OAAOe,SAAU,CAC1B,MAAO,MAGT,MAAOnB,OAAMI,OAAOe,SAASC,IAAI,SAASC,GACxC,MAAOA,GAAEC,OACRC,KAAK,KAGVvB,OAAMwB,oBAAsB,WAC1B,IAAKxB,MAAMI,OAAOqB,WAAY,CAC5B,MAAO,MAGT,GAAIzB,MAAMI,OAAOqB,WAAWd,SAAW,EAAG,CACxC,MAAO,GAGT,MAAO,OAASX,MAAMI,OAAOqB,WAAWF,KAAK,SAKvD,aAQA9B,SAAQC,OAAO,cACZC,UAAU,uBAAwB,WACjC,OACEC,YAAa,qEACbC,SAAU,IACVC,KAAM,QAASC,UAASC,MAAOC,QAASC,WAM9C,aAOAT,SAAQC,OAAO,cACZC,UAAU,gBAAiB,mBAC1B,SAAS+B,kBACP,OAEE9B,YAAa,qDACbC,SAAU,IACVC,KAAM,QAASC,UAASC,MAAOC,QAASC,OAyBtCF,MAAM2B,sBAAwB,SAASC,QACrC,GAAIC,QAAS,IAAM7B,MAAM8B,YAAYF,OACrC,OAAOC,QAGT7B,OAAM+B,mBAAqB,WACzB,MAAO,qBAGT/B,OAAM8B,YAAc,SAASF,QAC3B,MAAO,cAAgBA,OAAOI,QAQ1C,aAOAvC,SAAQC,OAAO,cACZC,UAAU,gBAAiB,mBAC1B,SAAS+B,kBACP,OAEE9B,YAAa,qDACbC,SAAU,IACVC,KAAM,QAASC,UAASC,MAAOC,QAASC,OACtCF,MAAMiC,oBAENjC,OAAMkC,KAAO,WACXlC,MAAMmC,gBAGRnC,OAAMmC,cAAgB,WACpBnC,MAAMiC,qBAGRjC,OAAMoC,iBAAmB,SAASC,uBAChC,GAAIC,2BAA4BtC,MAAMiC,kBAAkBtB,MACxD,IAAI4B,uBAAwBvC,MAAMwC,OAAOC,SAAS9B,MAElD0B,uBAAwBA,uBAAyB,KAAO,EAAIA,qBAC5D,IAAIK,2BAA4BH,sBAAwBD,yBACxDD,uBAAwBM,KAAKC,IAAIF,0BAA2BL,sBAC5D,IAAIQ,YAAaP,0BAA4BD,qBAC7C,KAAK,GAAIS,GAAIR,0BAA2BQ,EAAID,WAAYC,IAAK,CAC3D,GAAIC,gBAAiB/C,MAAMwC,OAAOC,SAASK,EAC3C9C,OAAMiC,kBAAkBe,KAAKD,iBAIjC/C,OAAM+B,mBAAqB,WACzB,MAAO,qBAGT/B,OAAMiD,sBAAwB,SAAST,QACrC,GAAIX,QAAS,IAAM7B,MAAMkD,YAAYV,OACrC,OAAOX,QAGT7B,OAAMkD,YAAc,SAASV,QAC3B,GAAIX,QAAS,cAAgBW,OAAOR,EACpC,OAAOH,QAGT7B,OAAMkC,WAKhB,aAQAzC,SAAQC,OAAO,cACZC,UAAU,eAAA,uBAAe,SAAUwD,sBAClC,OACEvD,YAAa,8CACbC,SAAU,IACVC,KAAM,QAASC,UAASC,MAAOC,QAASC,OACtC,GAAIkD,OAAQ,GAAID,sBAAqBnD,MAAMI,OAAOiD,mBAAoBrD,MAAMI,OAAOkD,WACnFtD,OAAMuD,YAAcH,UAK5B,aAOA3D,SAAQC,OAAO,cACZC,UAAU,cAAe,mBACxB,SAAS+B,kBACP,OAEE9B,YAAa,4CACbC,SAAU,IACVC,KAAM,QAASC,UAASC,MAAOC,QAASC,OACtCF,MAAMwD,OACJC,SAAU,MACVC,QAAS,KACTC,eAAgB,KAiBlB3D,OAAM+B,mBAAqB,WACzB,MAAO,qBAGT/B,OAAM4D,OAAO,uBAAwB,SAASC,kBAAmBC,mBAC/D,GAAID,mBAAqB,KAAM,CAC7B,cAOd,aASApE,SAAQC,OAAO,cACbqE,WAAW,4BAA6B,SAAU,mBAClD,4BAA6B,wBAC7B,gBACA,SAAUC,OAAQtC,iBAAkBuC,0BAA2BC,sBAAuBC,eACtFH,OAAOI,YAAc,KAErB,IAAIC,oBAAqB,WACxB,GAAIC,WACHC,WAAY,MACZC,UAAW,MACXC,uBAAwB,KACxBC,eAAgB,KAChBC,eAAgB,KAChBC,kBAAmB,KACnBC,0BAA2BC,IAAKA,KAEjC,OAAOR,UAGRN,QAAOM,SAAWD,oBAElBL,QAAOe,aAAe,SAASC,UAC9BhE,QAAQC,IAAI+D,UAGbhB,QAAOiB,aAAe,SAASC,aAC9B,GAAIA,aAAe,KAAM,CACxB,KAAM,IAAIC,OAAM,8BAOjB,GAAIC,sBAAuB,KAC3B,IAAIA,qBAAsB,CAGzBpB,OAAOM,SAASG,uBAAyB,IACzCT,QAAOM,SAASI,gBAAkBQ,YAClC,QAID,GAAIG,YAAaH,YAAYI,MAC7B,OAAOpB,uBAAsBqB,UAAUF,WAAYH,aACjDM,KAAK,SAASC,2BACdzB,OAAOM,SAASG,wBAA0BgB,0BAC1CzB,QAAOM,SAASI,gBAAkBQ,YAClCf,eAAc,cAAgBe,YAAYlD,GAC1C,OAAOyD,6BAIVzB,QAAO0B,mBAAqB,WAC3B,MAAOzB,2BAA0ByB,qBAC/BF,KAAK,SAASG,KACd,MAAOA,OAIV3B,QAAO4B,UAAY,WAClB5E,QAAQC,IAAI,mBAEZgD,2BAA0B4B,2BAG3B7B,QAAO8B,cAAgB,WACtB,GAAI9B,OAAOM,UAAY,KAAM,CAC5B,OAGDN,OAAOM,SAASC,YAAcP,OAAOM,SAASC,cAIjD,aAQA9E,SAAQC,OAAO,cACZC,UAAU,cAAA,2BAAc,SAASoG,0BAChC,OACEnG,YAAa,4CACbC,SAAU,IACVC,KAAM,SAASE,MAAOC,QAASC,OAC7B,GAAIS,QAASqF,WAAWhG,MAAMI,OAAO6F,YACrC,IAAItF,QAAU,EAAG,CACf,OAEF,GAAIuF,eAAgB,EAAIvF,MACxBX,OAAMwD,OACJ2C,MAAOlG,QAAQkG,QAAU,GAG3B,IAAIC,iBAAkB,GAEtB,IAAIC,iBAAkB,SAASJ,aAC7B,GAAIK,eAAgB3D,KAAK4D,MAAM5F,OAC/B,IAAI6F,aACJ,IAAIF,cAAgB,EAAG,CACrBE,UAAUxD,MACRyD,QAAS,EACTN,MAAO,EACPO,OAAQ,EACRC,QAAS,GAGX,OAAOH,WAGT,GAAII,WAAY5G,MAAMwD,MAAM2C,MAAQF,WACpC,KAAK,GAAInD,GAAI,EAAGA,GAAKwD,cAAexD,IAAK,CACvC0D,UAAUxD,MACRyD,QAAS3D,EAAI8D,UACbT,MAAO,IACPO,OAAQ,EACRC,QAAS,IAIb,MAAOH,WAITxG,OAAM6G,UAAY,WAEhB,GAAIlG,QAASqF,WAAWhG,MAAMI,OAAO6F,YACrC,IAAIC,eAAgB,EAAIvF,MACxBX,OAAM8G,WAAaC,GAAGC,OAAO/G,QAAQ,IAClCgH,OAAO,OACPC,KAAK,QAAS,eACdA,KAAK,QAASlH,MAAMwD,MAAM2C,OAC1Be,KAAK,SAAU,IACfA,KAAK,QAAS,6BAIjBlH,OAAMmH,eAAiBnH,MAAMI,OAAOgH,IAAIC,SAASjG,IAAI,SAASkG,SAC5D,MAAO,IAAIvB,0BAAyBuB,QAASpB,gBAI/ClG,OAAM8G,WAAWS,WAAavH,MAAM8G,WAAWG,OAAO,KACnDC,KAAK,QAAS,0BAGjBlH,OAAM8G,WAAWS,WAAWC,UAAU,QACnCC,KAAKzH,MAAMmH,gBAAgBO,QAC3BT,OAAO,QACPC,KAAK,IAAK,SAASS,GAClB,MAAOA,GAAElB,QAAUzG,MAAMwD,MAAM2C,QAEhCe,KAAK,IAAK,GACVA,KAAK,QAAS,SAASS,GACtB,MAAOA,GAAExB,MAAQnG,MAAMwD,MAAM2C,QAE9Be,KAAK,SAAU,IACfA,KAAK,KAAM,GACXA,KAAK,KAAM,GACXA,KAAK,QAAS,eACdA,KAAK,QAAS,eACdU,aACAC,MAAM,EAAIzB,iBACVc,KAAK,QAAS,aAIjBlH,OAAM8H,MAAQ9H,MAAMI,OAAO2H,MAAMV,SAASjG,IAAI,SAASkG,SACrD,MAAO,IAAIvB,0BAAyBuB,QAASpB,gBAM/ClG,OAAM8G,WAAWgB,MAAQ9H,MAAM8G,WAAWG,OAAO,KAC9CC,KAAK,QAAS,qBAGjBlH,OAAM8G,WAAWgB,MAAMN,UAAU,QAC9BC,KAAKzH,MAAM8H,OAAOJ,QAClBT,OAAO,QACPC,KAAK,IAAK,SAASS,GAClB,MAAOA,GAAElB,QAAUzG,MAAMwD,MAAM2C,QAEhCe,KAAK,IAAK,GACVA,KAAK,QAAS,SAASS,GACtB,MAAOA,GAAExB,MAAQnG,MAAMwD,MAAM2C,QAE9Be,KAAK,SAAU,GACfA,KAAK,KAAM,GACXA,KAAK,KAAM,GACXA,KAAK,QAAS,sBACdA,KAAK,QAAS,eACdU,aACAC,MAAM,EAAIzB,iBACVc,KAAK,QAAS,aAEjB,IAAIV,WAAYH,gBAAgB1F,OAChC,IAAIqH,WAAYxB,UAAU,EAE1BwB,WAAU7B,MAAQ,CAClB6B,WAAUtB,OAAS,CACnB1G,OAAM8G,WAAWN,UAAYxG,MAAM8G,WAChCG,OAAO,KACPC,KAAK,QAAS,0BACdM,UAAU,QAAQC,KAAKjB,WAAWkB,QAClCT,OAAO,QACPC,KAAK,IAAK,SAASS,GAClB,MAAO3H,OAAMwD,MAAM2C,MAAQwB,EAAElB,QAAUkB,EAAExB,QAE1Ce,KAAK,IAAK,SAASS,GAClB,MAAOA,GAAEhB,QAAU,IAEpBO,KAAK,QAAS,SAASS,GACtB,MAAOA,GAAExB,QAEVe,KAAK,SAAU,SAASS,GACvB,MAAOA,GAAEjB,SAEVQ,KAAK,QAAS,QACdA,KAAK,QAAS,eACdU,aACAC,MAAM,SAASF,EAAG7E,GACjB,MAAQ,KAAM0D,UAAU7F,OAAUmC,EAAK,GAAMsD,kBAE9Cc,KAAK,QAAS,aAIjBlH,OAAM8G,WAAW1G,OAASJ,MAAM8G,WAAWG,OAAO,KAC/CC,KAAK,QAAS,sBACdD,OAAO,QACPC,KAAK,IAAK,GACVA,KAAK,IAAK,GACVA,KAAK,SAAU,GACfA,KAAK,QAASlH,MAAMwD,MAAM2C,OAC1Be,KAAK,QAAS,eACdU,aACAC,MAAM,GAAMzB,iBACZc,KAAK,QAAS,aAGflH,OAAMiI,aAAejI,MAAMI,OAAOC,YAOpCL,OAAMmH,eAAiBnH,MAAMI,OAAO8H,aAAab,SAASjG,IAAI,SAASkG,SACrE,MAAO,IAAIvB,0BAAyBuB,QAASpB,gBAI/ClG,OAAM8G,WAAWqB,oBAAsBnI,MAAM8G,WAAWG,OAAO,KAC5DC,KAAK,QAAS,oBAGjBlH,OAAM8G,WAAWG,OAAO,KACrBC,KAAK,QAAS,qBACdM,UAAU,KAAKC,KAAKzH,MAAMmH,gBAAgBO,QAC1CT,OAAO,KACPA,OAAO,QACPC,KAAK,IAAK,SAASS,GAClB,MAAOA,GAAElB,QAAUzG,MAAMwD,MAAM2C,QAEhCe,KAAK,IAAK,GACVA,KAAK,QAAS,SAASS,GACtB,MAAOA,GAAExB,MAAQnG,MAAMwD,MAAM2C,QAE9Be,KAAK,SAAU,GACfA,KAAK,QAAS,qBACdA,KAAK,QAAS,eACdU,aACAC,MAAM,EAAIzB,iBACVc,KAAK,QAAS,aAGjBlH,OAAMI,OAAOM,aAAa0H,QAAQ,SAASC,YAAaC,OAEtD,GAAIC,mBAAoBF,YAAYhB,SAASjG,IAAI,SAASkG,SACxD,GAAIkB,0BAA2B,GAAIzC,0BAAyBuB,QAASpB,cACrEoB,SAAQA,QAAUkB,wBAClB,OAAOlB,UAGTtH,OAAM8G,WAAWG,OAAO,KACrBC,KAAK,QAASoB,QAAU,EAAI,0BAA4B,qCACxDd,UAAU,KAAKC,KAAKc,mBAAmBb,QACvCT,OAAO,KAIPA,OAAO,QACPC,KAAK,IAAK,SAASS,GAClB,MAAOA,GAAEL,QAAQb,QAAUzG,MAAMwD,MAAM2C,QAExCe,KAAK,IAAK,GACVA,KAAK,QAAS,SAASS,GACtB,MAAOA,GAAEL,QAAQnB,MAAQnG,MAAMwD,MAAM2C,QAEtCe,KAAK,SAAU,GACfA,KAAK,QAAS,eACdA,KAAK,QAAS,eACdU,aACAC,MAAM,EAAIzB,iBACVc,KAAK,QAAS,eAGnBlH,OAAM8G,WAAW2B,kBAAoBzI,MAAM8G,WAAWG,OAAO,KAC1DC,KAAK,QAAS,gCAGjBlH,OAAM8G,WAAW2B,kBAAkBjB,UAAU,UAC1CC,KAAKzH,MAAMiI,cAAcP,QACzBT,OAAO,UACPC,KAAK,KAAM,KACXA,KAAK,IAAK,GACVA,KAAK,KAAM,SAASS,GACnB,OAAQ,EAAKA,EAAEe,aAAe/H,QAAWX,MAAMwD,MAAM2C,QAEtDe,KAAK,QAAS,SAASS,GACtB,GAAIgB,iBAAkBhB,EAAEiB,yBAA2B,OAASjB,EAAEkB,iCAAmC,KACjG,IAAIF,gBAAiB,CACnB,MAAO,2BAGT,GAAIhB,EAAEiB,yBAA2B,MAAO,CACtC,MAAO,0BAET,MAAO,2BAER1B,KAAK,QAAS,eACdU,aACAC,MAAM,SAASF,EAAG7E,GACjB,MAAQ,KAAM9C,MAAMiI,aAAatH,OAAUmC,EAAK,EAAIsD,kBAErDc,KAAK,QAAS,cAOnBlH,OAAM6G,gBAId,eACA,SAAUpH,SACN,GAAIqJ,KAAMrJ,QAAQC,OAAO,MAEzBoJ,KAAInJ,UAAU,mBAAoB,aAAc,SAASoJ,YACrD,OACIlJ,SAAU,KACVmJ,QAAS,MACThJ,OACIiJ,WAAY,IACZC,WAAY,IACZC,oBAAqB,IACrBC,cAAe,IACfC,aAAc,IACdC,eAAgB,KAEpBxJ,KAAM,SAASE,MAAOC,QAASsJ,WAAYC,SACvC,GAAIC,QAASC,EAAEzJ,QAAS0J,KACxB,IAAIC,YAAa,WAEb,GAAIC,iBACJ,IAAIC,SAAW,MAAQA,QAAQnJ,SAAW,EAAG,CACzCmJ,QAAUJ,EAAE1J,MAAMiJ,YAGtB,MAAOa,SAGX9J,OAAMsJ,eAAiBtJ,MAAMsJ,gBAAkB,KAAOtJ,MAAMsJ,eAAiB,GAE7E,IAAIQ,SAAUF,YACd,IAAIG,cAAe,IACnB,IAAID,SAAUJ,EAAE1J,MAAMiJ,WACtB,IAAIE,qBAAsBO,EAAE1J,MAAMmJ,oBAClC,IAAIC,eAAgBpJ,MAAMoJ,eAAiB,CAE3C,IAAID,oBAAoBxI,SAAW,EAAG,CAClCwI,oBAAsBO,EAAEM,QAG5B,QAASC,wBACL,GAAIF,aAAaG,GAAG,OAASH,aAAaG,GAAG,SAAU,CACnD,GAAIC,eAAgBJ,aAAaK,KAAK,KACtCX,QAAOW,KAAK,MAAMC,KAAK,SAAS/B,MAAOgC,QACnC,GAAIC,cAAeb,EAAES,cAAc7B,OACnCiC,cAAaC,IAAI,QAASF,OAAOG,YAAc,SAK3D,QAASC,uBACL,GAAIC,WAAYxB,oBAAoBwB,YAAc3K,MAAMkJ,UACxD,IAAI0B,gBAAiBhB,YACrB,IAAIgB,eAAejK,SAAW,EAAG,CAC7B,OAEJ,GAAIkK,YAAaD,eAAeE,SAASC,GACzC,IAAIC,eAAgBH,WAAaD,eAAeK,YAAY,MAE5D,IAAKN,UAAYE,YAAgBF,UAAYK,cAAgB,CACzD,IAAKjB,aAAc,CACfmB,aACAnB,cAAaS,KACTW,WAAc,YAItB,GAAIR,UAAYK,eAAiBL,UAAYK,cAAgBjB,aAAakB,YAAY,OAAQ,CAC1F,GAAIF,KAAMC,cAAgBL,UAAY3K,MAAMkJ,WAAaa,aAAakB,YAAY,MAClFlB,cAAaS,IAAI,MAAOO,IAAM,UAC3B,CACHK,qBAED,CACH,GAAIrB,aAAc,CAIdN,OAAO4B,QACP5B,QAASM,YACTA,cAAe,IAEfN,QAAO6B,YAAY,oBACnB7B,QAAOe,KACHe,SAAU,WACVC,KAAM,EACNT,IAAK,EACL5E,MAAO,OACPsF,UAAW,EACXN,WAAY,cAM5B,QAASC,iBACLrB,aAAaS,KACTO,IAAK/K,MAAMkJ,WACX/C,MAAOsD,OAAOiC,aACdF,KAAM/B,OAAOqB,SAASU,MAG1BvB,wBAGJ,QAASiB,eAILnC,WAAW4C,WAAW,eAAgB3L,MAAMqJ,aAC5CU,cAAeN,MACfA,QAASM,aAAa6B,OACtB7B,cAAa8B,MAAMpC,OACnBM,cAAa+B,SAAS,oBACtB/B,cAAaS,KACTe,SAAU,QACVE,UAAWzL,MAAMsJ,eACjB6B,WAAY,UAEhBC,iBAGJjC,oBAAoB4C,GAAG,yBAA0BrB,qBAAqBsB,QAAQ,SAC9E7C,qBAAoB4C,GAAG,yBAA0BrB,oBAEjD1K,OAAMiM,IAAI,WAAY,WAClB9C,oBAAoB+C,IAAI,0BAMxCpD,KAAInJ,UAAU,WAAY,YAAa,SAASwM,WAC5C,OACItM,SAAU,IACVG,SACAF,KAAM,SAASE,MAAOoM,GAAIlM,OACtB,GAAImM,gBAAiB5M,QAAQQ,QAAQmM,GACrC,IAAIE,YAAaD,eAAejC,KAAK,kBACrC,IAAImC,WAAYF,eAAejC,KAAK,yBACpC,IAAIoC,YAAa,CAEjB,SAASC,aAAYC,GACjB,GAAIC,WAAYlN,QAAQQ,QAAQyM,EAAEE,cAElC,IAAIC,SAAUF,UAAUG,KAAK,gBAG7BD,SAAQE,YAAY,OAAQ,WAExB,GAAIC,SAAUL,UAAUlK,SAAS,wBACjCuK,SAAQC,YAAY,gCAGpBV,WAAYF,eAAejC,KAAK,4BAKxC,QAAS8C,eAAcR,GACnBF,WAAaW,oBAEb,IAAIT,EAAEU,UAAY,EAAG,CACjBC,aAAaX,OACV,IAAIA,EAAEU,UAAY,IAAMV,EAAEU,UAAY,IAAMV,EAAEU,UAAY,GAAI,CACjEE,gBAAgBZ,OACb,IAAIA,EAAEU,UAAY,IAAMV,EAAEU,UAAY,GAAI,CAC7CG,kBAAkBb,IAI1B,QAASW,cAAaX,GAClB,GAAIA,EAAEc,SAAU,CACZ9D,EAAE,qBAAqB+D,YACpB,CACH,GAAIC,cAAehE,EAAE,eAErB,IAAIgE,aAAa/M,QAAU,EAAG,CAC1B,WACG,CACH+M,aAAaD,SAIrBf,EAAEiB,gBACFjB,GAAEkB,kBAGN,QAASN,iBAAgBZ,GACrBA,EAAEE,cAAgBlD,EAAE6C,UAAUC,aAAa/J,SAAS,KAAKoL,OACzDpB,aAAYC,GAGhB,QAASa,mBAAkBb,GACvBA,EAAEiB,gBACFjB,GAAEkB,iBAEF,IAAIlB,EAAEU,UAAY,GAAI,CAClB,GAAIZ,WAAa,EAAG,CAChB9C,EAAE6C,UAAUC,WAAa,IAAI/J,SAAS,KAAKoL,QAAQJ,YAChD,CACH/D,EAAE6C,UAAUA,UAAU5L,OAAS,IAAI8B,SAAS,KAAKoL,QAAQJ,aAE1D,IAAIf,EAAEU,UAAY,GAAI,CACzB,GAAIZ,WAAcD,UAAU5L,OAAS,EAAI,CACrC+I,EAAE6C,UAAUC,WAAa,IAAI/J,SAAS,KAAKoL,QAAQJ,YAChD,CACH/D,EAAE6C,UAAU,IAAI9J,SAAS,KAAKoL,QAAQJ,UAKlD,QAASN,sBACL,GAAIW,aAAczB,eAAejC,KAAK,SAEtC,IAAI0D,YAAYnN,SAAW,EAAG,CAC1B,MAAO4L,WAAUjE,MAAMwF,YAAYxI,OAAO,kBAAkBuI,SAGhE,MAAOtB,WAAUjE,MAAM+D,eAAejC,KAAK,yBAAyByD,SAGxE,QAASE,aAAYrB,GACjBA,EAAEiB,gBACFjB,GAAEkB,iBAEFpB,YAAaW,oBACbzD,GAAE6C,UAAUC,aAAa/J,SAAS,KAAKoL,QAAQJ,QAGnDnB,WAAW0B,MAAMvB,YACjBJ,gBAAe4B,QAAQf,cACvBb,gBAAeoB,MAAMM,YAErB/N,OAAM4D,OAAO,WACT,MAAOuI,WAAU+B,QAClB,SAASA,MAER,GAAIC,cAAe/B,GAAGhC,KAAK,eAE3B3K,SAAQ2I,QAAQ+F,aAAc,SAASC,UACnC,GAAIC,MAAO5O,QAAQQ,QAAQmO,SAC3B,IAAItO,MAAOuO,KAAKnH,KAAK,QAAQoH,MAAM,KAAK,EAExC,IAAIJ,KAAKK,QAAQzO,OAAS,EAAG,CAEzBL,QAAQQ,QAAQmO,SAASI,eAAe1C,SAAS,SAGjD,IAAI2C,UAAWJ,KAAKK,QAAQ,gBAC5BD,UAASE,MAGT,IAAIC,UAAWH,SAASI,OAAOpM,SAAS,wBACxCmM,UAAStD,YAAY,kBACrBsD,UAAS9C,SAAS,qBACf,CACHrM,QAAQQ,QAAQmO,SAASI,eAAelD,YAAY,YAI5DiB,WAAYF,eAAejC,KAAK,gCAMhDtB,KAAInJ,UAAU,gBAAiB,WAC3B,OACIE,SAAU,KACVmJ,QAAS,MACThJ,SACAF,KAAM,SAASE,MAAOC,QAASsJ,WAAYC,SACvC,GAAIsF,YAAapF,EAAEzJ,QAAS0J,KAE5BmF,YAAWhD,SAAS,kBACpBgD,YAAWb,QAAQf,cACnBxD,GAAE,QAAQuE,QAAQc,cAElB,SAASA,eAAcrC,GACnB,GAAIA,EAAEU,UAAY,IAAMV,EAAEsC,SAAWtC,EAAEuC,OAAQ,CAC3C,GAAIC,eAAgB,CAChBzC,cAEJ/C,EAAE,cAAc+D,YACb,IAAIf,EAAEU,UAAY,IAAMV,EAAEsC,QAAS,CACtCF,WAAWrB,OACXhB,gBAIR,QAASyC,gBACL,MAAOxF,GAAE,QAAQyF,SAAS,mBAG9B,QAAS1C,eACL/C,EAAE,QAAQuD,YAAY,kBACtBmC,cACAC,YAAWD,YAAa,IAG5B,QAASlC,eAAcR,GACnB,GAAIA,EAAEU,UAAY,IAAMV,EAAEU,UAAY,GAAI,CACtCV,EAAEiB,gBACFjB,GAAEkB,iBACFnB,gBAIR,QAAS2C,eACLN,WAAW1E,KAAK,yBAAyB6C,YAAY,mBACrD6B,YAAW1E,KAAK,0BAA0B6C,YAAY,qBAG1D6B,WAAW/C,GAAG,sBAAuBU,YAErCzM,OAAMiM,IAAI,WAAY,WAClB6C,WAAW5C,IAAI,uBAM/BpD,KAAInJ,UAAU,cAAe,UAAW,SAAS2P,SAE7C,OACIzP,SAAU,KACVG,SACAgJ,QAAS,MACTuG,WAAY,KACZzP,KAAM,SAASE,MAAOC,QAASC,MAAO6D,WAAYwL,YAC9C,GAAIC,SAAUF,QAAQ,UACtB,IAAIG,aAAc,CAClB,IAAIC,eAAgBxP,MAAMyP,WAAWrB,MAAM,QAAQ,EACnD,IAAIsB,qBAAsB1P,MAAMyP,WAAWrB,MAAM,QAAQ,EACzD,IAAIuB,UAAWC,SAASF,oBAAoBtB,MAAM,UAAU,GAAI,GAChE,IAAIyB,YAAaH,oBAAoBtB,MAAM,UAAU,EAQrD,IAAI0B,WACJ,IAAIC,cACJ,IAAIC,aACJ,IAAIC,MAAOzG,EAAEM,OACb,IAAIoG,YAAa,OAAQ,YAAa,aACtC,IAAIC,eAEJd,YAAW,SAAS3D,MAAO0E,kBAEvBA,iBAAiBF,UAAYA,SAE7BnQ,SAAQgH,OAAO2E,MACf0E,kBAAiBZ,eAAiBQ,SAElC,SAASK,YACL,GAAIC,WAAYP,WAAWQ,MAAMZ,SAAWJ,YAAcI,UAAYJ,YAAc,GACpF,IAAIe,UAAU7P,OAAS,EAAG,CACtBuP,UAAUlN,KAAK0N,MAAMR,UAAWM,UAChCf,gBAIR,QAASkB,cACL,GAAIN,YAAY1P,OAAQ,CACpBsP,WAAaT,QAAQQ,QAASK,iBAC3B,CACHJ,WAAaD,QAGjBE,UAAUvP,OAAS,CACnB8O,aAAc,CACdc,YAGJ,QAASK,eAAcC,WAAYC,UAG/B,IAAK,GAAIhO,GAAI,EAAGA,EAAIuN,YAAY1P,OAAQmC,IAAK,CACzC,GAAIuN,YAAYvN,GAAGyL,QAAQsC,aAAe,EAAG,CACzCR,YAAYU,OAAOjO,EAAG,IAK9B,GAAIgO,SAAW,EAAG,CACd,GAAIE,WAAY,EAChB,IAAIZ,UAAUU,YAAc,aAAc,CACtCE,UAAY,IAEhBX,YAAYY,QAAQD,UAAYH,YAGpCF,aAGJ,QAASO,gBACL,GAAIC,GAAIzH,EAAEM,QAAQW,WAClB,IAAIhD,GAAI+B,EAAE0H,UAAU1K,QACpB,IAAIrF,GAAIqI,EAAEM,QAAQtD,QAClB,IAAI2K,eAAiBF,GAAKxJ,EAAItG,EAE9B,IAAIgQ,cAAgB,IAAM,CAItBf,iBAAiBgB,OAAOf,WAIhCD,iBAAiBiB,QAAQC,iBAAiBzB,WAAY,SAAS0B,SAC3D,GAAIA,QAAS,CACTzB,QAAUyB,OACVd,gBAIRL,kBAAiBM,cAAgBA,aAEjCT,MAAKpE,GAAG,oBAAqBmF,cAAclF,QAAQ,SAEnDsE,kBAAiBrE,IAAI,WAAY,WAC7BkE,KAAKjE,IAAI,uBAO7BpD,KAAInJ,UAAU,WAAY,WACtB,GAAI+R,kBAAmB,4BAEvB,QACI7R,SAAU,KACVmJ,QAAS,MACThJ,SACAF,KAAM,SAASE,MAAOC,QAASC,OAC3B,GAAIyR,cAAe1R,OACnB,IAAI4Q,YAAa3Q,MAAM0R,OACvB,IAAIC,UAAWpS,QAAQQ,QAAQyR,iBAC/BC,cAAa1K,OAAO,SACpB0K,cAAa1K,OAAO4K,SACpB,IAAIC,iBAAkB,CAEtB,SAASC,aACLF,SAASvG,YAAY,mCAErB,IAAI0G,YAAa,SAEjB,IAAIhS,MAAMuR,QAAQnB,UAAU0B,mBAAqB,YAAa,CAC1DE,WAAa,kBACV,IAAIhS,MAAMuR,QAAQnB,UAAU0B,mBAAqB,aAAc,CAClEE,WAAa,eAGjBH,SAAS/F,SAASkG,YAGtB,QAASC,aAELH,iBACA,IAAIA,iBAAmB9R,MAAMuR,QAAQnB,UAAUzP,OAAQ,CACnDmR,gBAAkB,EAGtB9R,MAAMsR,OAAOtR,MAAMuR,QAAQX,cAAcC,WAAYiB,iBAErDC,aAGJJ,aAAanH,KACT0H,OAAQ,WAGZP,cAAa5F,GAAG,gBAAiBkG,UAEjCN,cAAa5F,GAAG,kBAAmB,SAASW,GACxC,GAAIA,EAAEU,UAAY,GAAI,CAClB6E,WACAvF,GAAEiB,gBACFjB,GAAEkB,oBAIV5N,OAAMiM,IAAI,WAAY,WAClB0F,aAAazF,IAAI,qBAKlClC,OAAOvK,QACV,aAQAA,SAAQC,OAAO,cACZC,UAAU,iBAAkB,WAC3B,OACEC,YAAa,oDACbC,SAAU,IACVC,KAAM,QAASC,UAASC,MAAOC,QAASC,WAG9C,aAQAT,SAAQC,OAAO,cACZC,UAAU,oBAAqB,WAC9B,OACEC,YAAa,qDACbC,SAAU,IACVC,KAAM,QAASC,UAASC,MAAOC,QAASC,OACvCc,QAAQC,IAAI,8BAA+BjB,MAAMI,WAKxD,aASA,IAAI+R,gBAAiB,cAErB1S,SAAQC,OAAO,cACZC,UAAU,oBACT,aAAc,qBAAsB,KAAM,WAC1C,SAASoJ,WAAYqJ,mBAAoBC,GAAIC,UAC3C,OAEE1S,YAAa,sCACbC,SAAU,IACVC,KAAM,QAASC,UAASC,MAAOC,QAASC,OACtCF,MAAMuS,cACJ/N,UAAW,KACXgO,iBAAkB,KAClBC,iBAAkB,KAClBC,iBAAkB,KAClBvM,MAAO,GACPO,OAAQ,GACRiM,QAAS,KAETC,cAAe7L,GAAGC,OAAO,MAG3BhH,OAAM6S,OAAS9L,GAAGC,OAAO,KACzBhH,OAAM2E,eAAiBoC,GAAGC,OAAO,KAEjC+B,YAAWkD,IAAI,gBAAiB,SAAS6G,MAAOC,MAC9C/R,QAAQC,IAAI8R,OAIdhK,YAAWkD,IAAI,eAAgB,SAAS6G,MAAOC,MAC7C,GAAIA,MAAQ,KAAM,CAChB,OAGF,GAAIA,KAAKC,OAAS,SAAU,CAC1BV,SAAS,WACPtS,MAAMuS,aAAaE,iBAAmBM,KAAK/Q,EAC3ChC,OAAMsR,UAER,QAGF,GAAIyB,KAAKC,OAAS,SAAU,CAC1BV,SAAS,WACPtS,MAAMuS,aAAaG,iBAAmBK,KAAKE,IAC3CjT,OAAMsR,UAER,UAIJ,IAAI4B,iBAAkBlT,MAAM4D,OAAO,WACjC,MAAO5D,OAAMuS,aAAaE,kBACzB,SAASU,YAAaC,aACvB,GAAID,aAAe,KAAM,CACvB,OAGF,GAAIA,cAAgBC,YAAa,CAC/B,OAIF,GAAIC,cAAerT,MAAMsT,eAAeC,OAAO,SAASC,GACtD,MAAOA,GAAExR,KAAOmR,aAGlB,IAAIE,aAAa1S,OAAS,GAAKwS,cAAgBC,YAAa,CAC1DK,eAAeJ,aAAa,MAKhC,IAAIK,iBAAkB1T,MAAM4D,OAAO,WACjC,MAAO5D,OAAMuS,aAAaG,kBACzB,SAASiB,UAAWC,WACrB,GAAID,WAAa,KAAM,CACrB,OAIF,GAAIE,cAAe7T,MAAM8T,gBAAgBP,OAAO,SAASC,GACvD,MAAOA,GAAEP,OAASU,WAEpB,IAAIE,aAAalT,OAAS,GAAKgT,YAAcC,UAAW,CACtD7O,aAAa8O,aAAa,MAI9B,IAAIE,mBAAoB/T,MAAM4D,OAAO,WACnC,MAAO5D,OAAMuS,aAAaC,kBACzB,SAASwB,cAAeC,eACzB,GAAID,eAAiB,KAAM,CACzB,OAGFE,eAAeF,gBAGjB,IAAIE,gBAAiB,SAASC,YAC5B,GAAIC,MAAOrN,GAAGC,OAAO/G,QAAQ,IAG/B,IAAIoU,iBAAkB,SAASrP,UAC7BhE,QAAQC,IAAI,oBAGd,IAAIqT,cAAe,SAASC,UAC1BvT,QAAQC,IAAI,kBAQd,IAAIuT,eAAgB,SAASC,aAE3BzU,MAAM0U,WAAa3N,GAAG4N,IAAIC,YACvBC,MAAM,GACNC,WAAW,EAAG,GAGjB9U,OAAMkO,KAAOnH,GAAG4N,IAAIzG,OACjBwG,WAAW1U,MAAM0U,YACjBK,YAAY,IAEf,IAAIC,OAAQP,YAAYQ,QAGxB,IAAIC,GAAIlV,MAAMkO,KAAKiH,OAAOH,OACxB7D,EAAI,IAAOxO,KAAKyS,KAAKF,EAAE,GAAG,GAAKA,EAAE,GAAG,IAAMlV,MAAMuS,aAAapM,OAAQ+O,EAAE,GAAG,GAAKA,EAAE,GAAG,IAAMlV,MAAMuS,aAAa7L,QAC7G2O,IAAMrV,MAAMuS,aAAapM,MAAQgL,GAAK+D,EAAE,GAAG,GAAKA,EAAE,GAAG,KAAO,GAAIlV,MAAMuS,aAAa7L,OAASyK,GAAK+D,EAAE,GAAG,GAAKA,EAAE,GAAG,KAAO,EAGzHlV,OAAM0U,WACHG,MAAM1D,GACN2D,UAAUO,EAEbrV,OAAMsV,KAAOvO,GAAGwO,SAASD,OACtBR,WAAW,EAAG,IACdD,MAAM,GACNW,aAAa,EAAG,IAChBC,MAAMzV,MAAMuS,aAAapM,MAAOnG,MAAMuS,aAAa7L,SACnDqF,GAAG,OAAQ2J,OAEd1V,OAAM2V,IAAM5O,GAAGC,OAAO/G,QAAQ,IAAI+G,OAAOmL,gBACtClL,OAAO,OACPC,KAAK,UAAW,OAASlH,MAAMuS,aAAapM,MAAQ,IAAMnG,MAAMuS,aAAa7L,QAC7EQ,KAAK,sBAAuB,iBAC5BA,KAAK,QAAS,gBACd6E,GAAG,QAAS6J,QAAS,KAExB5V,OAAMoU,KAAOpU,MAAM2V,IAAI1O,OAAO,KAC3BC,KAAK,QAAS,oBAEjBlH,OAAMoU,KAAKnN,OAAO,QACfC,KAAK,QAAS,gCACdA,KAAK,QAAS,QACdA,KAAK,SAAU,QACf6E,GAAG,QAAS8J,kBAEf7V,OAAM8V,SAAW9V,MAAMoU,KAAKnN,OAAO,KAChCC,KAAK,QAAS,+CAEjBlH,OAAM+V,OAAS/V,MAAMoU,KAAKnN,OAAO,KAC9BC,KAAK,QAAS,6CAEjBlH,OAAM0D,QAAU1D,MAAMoU,KAAKnN,OAAO,KAC/BC,KAAK,QAAS,8CAEjBlH,OAAMgW,QAAUhW,MAAMoU,KAAKnN,OAAO,KAC/BC,KAAK,QAAS,+CAGnB,IAAI+O,eAAgB,SAASzT,OAAQ+R,UACnC,GAAI5B,SAAU3S,MAAMuS,aAAaI,OACjC,IAAIA,QAAS,CAGXuD,aAAaC,KAAKxM,MAAMnH,OACxBxC,OAAMuS,aAAaE,iBAAmBjQ,OAAOR,EAC7ChC,OAAMiF,aAAazC,QAChBgD,KAAK,SAASyP,UACb3C,SAAS,WAEP8D,iBAEA9D,UAAS+D,cAAe,MACvB,WAKF,CACLC,iBAGFhE,SAAS,WACPtS,MAAMsR,WAIV,IAAIuE,mBAAoB,WACtB,GAAIU,aAAcvW,MAAMuS,aAAaI,OACrC,IAAI4D,YAAa,CAGf,GAAIvW,MAAMsE,SAASI,gBAAkB,MAAQ1E,MAAMsE,SAASI,eAAe/D,SAAW,EAAG,CACvF,OAIF8S,eAAezT,MAAMsE,SAASI,eAAe,GAC7C2R,qBAEK,CAELC,iBAGFhE,SAAS,WACPtS,MAAMsR,WAKV,IAAI+E,eAAgB,WAClBrW,MAAMuS,aAAaI,QAAU,MAG/B,IAAI2D,gBAAiB,WACnBtW,MAAMuS,aAAaI,QAAU,IAC7B6D,SAIF,IAAIC,mBAAoB,SAASV,OAAQC,QAASF,UAEhD9V,MAAM8V,SAAStO,UAAU,iCACtBC,KAAKqO,SAAU,SAASnO,GACvB,MAAOA,GAAE3F,KAEV0F,QAAQT,OAAO,QACfC,KAAK,IAAK,SAASS,GAClB,MAAO3H,OAAMkO,KAAKvG,EAAEsN,YAErB/N,KAAK,UAAW,SAASS,GACxB,MAAO+O,qBAAoB/O,KAE5BT,KAAK,QAAS,2BAEjBlH,OAAMgW,QAAQxO,UAAU,iCACrBC,KAAKuO,QAAS,SAASrO,GACtB,MAAOA,GAAE3F,KAEV0F,QAAQT,OAAO,QAEjBC,KAAK,QAAS,4BACZA,KAAK,UAAW,SAASS,GACxB,MAAOA,GAAE3F,KAEVkF,KAAK,KAAM,SAASS,GACnB,MAAO,UAAYA,EAAE3F,KAEtBkF,KAAK,YAAa,SAASS,GAC1B,MAAOA,GAAEgP,YAEVzP,KAAK,IAAK,SAASS,GAClB,MAAO3H,OAAMkO,KAAKvG,EAAEsN,YAErBlJ,GAAG,QAASkK,eAGjB,SAASO,SACPxW,MAAM6S,OAAO+D,QAAQ,SAAU,MAC/B5W,OAAM6S,OAAS9L,GAAGC,OAAO,KAEzBhH,OAAM2V,IAAI/N,aACPiP,SAAS,KACTC,KAAK9W,MAAMsV,KAAKR,WAAW,EAAG,IAAID,MAAM,GAAG/B,OAGhD,QAAS4C,UACP1V,MAAMoU,KAAK2C,MAAM,eAAgB,IAAMhQ,GAAG+L,MAAM+B,MAAQ,KACxD7U,OAAMoU,KAAKlN,KAAK,YAAa,aAAeH,GAAG+L,MAAMgC,UAAY,UAAY/N,GAAG+L,MAAM+B,MAAQ,KAGhG,QAASqB,cAAac,eACpBZ,iBACApW,OAAMuS,aAAaK,cAAgB7L,GAAGC,OAAO2C,MAAMiN,QAAQ,mCAAoC,KAE/F,IAAIK,gBAAiBD,cAAcvU,SAASrB,IAAI,SAASQ,QACvD,MAAOA,QAAOa,UAGhB,IAAIyU,iBAAkB5W,EAAE6W,OAAO7W,EAAE8W,QAAQH,gBAAiB,KAG1D,IAAII,eAAgBrX,MAAM0D,QAAQ8D,UAAU,iCACzCC,KAAKyP,gBAAiB,SAASvP,GAC9B,MAAOA,GAAE2P,IAEbD,eAAc3P,QACXT,OAAO,QACPC,KAAK,QAAS,4BACdA,KAAK,UAAW,SAASS,GACxB,MAAOA,GAAE3F,KAEVkF,KAAK,KAAM,SAASS,GACnB,MAAO,eAAiBA,EAAE3F,KAE3BkF,KAAK,YAAa,SAASS,GAC1B,MAAOA,GAAEsL,OAEV/L,KAAK,IAAK,SAASS,GAClB,MAAO3H,OAAMkO,KAAKvG,EAAEsN,YAErB8B,MAAM,UAAW,GACjBnP,aACAC,MAAM,KACNgP,SAAS,KACTE,MAAM,UAAW,EAEpBM,eAAcE,OACX3P,aACAiP,SAAS,KACTE,MAAM,UAAW,GACjB1L,SAIL,QAAS+K,mBACP,GAAIpW,MAAMuS,aAAaK,eAAiB,KAAM,CAC5C,OAGF5S,MAAMuS,aAAaK,cAAcgE,QAAQ,mCAAoC,MAC7E5W,OAAMuS,aAAaK,cAAgB7L,GAAGC,OAAO,MAG/C,QAASyM,gBAAe9L,EAAG0N,GACzB,GAAIrV,MAAM6S,OAAO2E,SAAW7N,KAAO,CACjC,MAAO6M,SAETxW,MAAM6S,OAAO+D,QAAQ,SAAU,MAE/B,IAAIzB,QAASnV,MAAMkO,KAAKiH,OAAOxN,EAAEsN,UAC/BwC,GAAKtC,OAAO,GAAG,GAAKA,OAAO,GAAG,GAC9BuC,GAAKvC,OAAO,GAAG,GAAKA,OAAO,GAAG,GAC9BwC,GAAKxC,OAAO,GAAG,GAAKA,OAAO,GAAG,IAAM,EACpCyC,GAAKzC,OAAO,GAAG,GAAKA,OAAO,GAAG,IAAM,EACpCN,MAAQ,IAAOlS,KAAKyS,IAAIqC,GAAKzX,MAAMuS,aAAapM,MAAOuR,GAAK1X,MAAMuS,aAAa7L,QAC/EoO,WAAa9U,MAAMuS,aAAapM,MAAQ,EAAI0O,MAAQ8C,EAAG3X,MAAMuS,aAAa7L,OAAS,EAAImO,MAAQ+C,EAEjG5X,OAAM2V,IAAI/N,aACPC,MAAM,KACNgP,SAAS,KACTC,KAAK9W,MAAMsV,KAAKR,UAAUA,WAAWD,MAAMA,OAAO/B,OAGvD,QAAS+E,aAAYC,eACnB,GAAIA,eAAiB,KAAM,CACzB,MAAO,GAGT,GAAIC,MAAOD,cAAcE,QAAUF,cAAcG,QACjD,OAAOF,MAGT,QAASrB,qBAAoBoB,eAC3B,MAAO,UAAYD,YAAYC,eAGjC,QAAS/S,cAAa4C,GACpB,GAAIoQ,MAAOrB,oBAAoB/O,EAC/B,IAAIuQ,WAAY,YAAcH,KAAO,GACrC,IAAI1C,GAAIrV,MAAM8V,SAAS9O,OAAOkR,WAAWV,MACzC,IAAIxX,MAAM2E,eAAe6S,SAAWnC,EAAG,CACrC,OAGFrV,MAAM2E,eAAeiS,QAAQ,SAAU,MACvC5W,OAAM2E,eAAiBoC,GAAGC,OAAOqO,GAAGuB,QAAQ,SAAU,MAGxD,QAAShB,WACP,GAAI7O,GAAG+L,MAAMqF,iBAAkBpR,GAAG+L,MAAMlF,kBAG1C5N,MAAM0F,qBACHF,KAAK,SAASG,KAEb,GAAIoQ,QAASzV,EAAEc,IAAIuE,IACnB,IAAIqQ,SAAU1V,EAAEyV,QACbqC,MAAM,YACNhB,UACAiB,OAEH,IAAIvC,UAAWxV,EAAE0V,SACdoC,MAAM,YACNhB,UACAiB,OAEHrY,OAAMsY,aAAevC,OAAO,EAC5B/V,OAAM8T,gBAAkBgC,QACxB9V,OAAMsT,eAAiB0C,OAEvB,IAAIuC,gBAAiB,CACrB,IAAIC,oBAAqBxY,MAAM8T,gBAAgB1S,IAAI,SAASqX,MAC1D,MAAO9V,MAAKyS,IAAI,EAAGqD,KAAKC,eAE1B,IAAIC,gBAAiB5R,GAAGqO,IAAIoD,mBAE5BxY,OAAM4Y,sBAAwB7R,GAAG8N,MAAMgE,SACpCC,QAAQP,eAAgBI,iBACxBI,OAAO,UAAW,WAGrB/Y,OAAMuS,aAAa/N,UAAY,KAC/BgQ,eAAcxU,MAAMsY,aACpB7B,mBAAkBV,OAAQC,QAASF,WAIvC9V,OAAMiM,IAAI,WAAY,WACpBiH,iBACAQ,kBACAK,oBACAiF,kCAMZ,WACC,YASAvZ,SAAQC,OAAO,cACbqE,WAAW,kBAAmB,SAAU,mBACxC,4BAA6B,wBAC7B,gBACA,SAASC,OAAQtC,iBAAkBuC,0BAA2BC,sBAAuBC,eACpFH,OAAOI,YAAc,IACrB,IAAIC,oBAAqB,WACxB,GAAIC,WACHC,WAAY,MACZC,UAAW,MACXC,uBAAwB,KACxBC,eAAgB,KAChBC,eAAgB,KAChBC,kBAAmB,KACnBC,0BAA2BC,IAAKA,KAEjC,OAAOR,UAGRN,QAAOM,SAAWD,oBAElBL,QAAOe,aAAe,SAASC,UAC9BhE,QAAQC,IAAI+D,UAGbhB,QAAOiB,aAAe,SAASC,aAC9B,GAAIA,aAAe,KAAM,CACxB,KAAM,IAAIC,OAAM,8BAOjB,GAAIC,sBAAuB,KAC3B,IAAIA,qBAAsB,CAGzBpB,OAAOM,SAASG,uBAAyB,IACzCT,QAAOM,SAASI,gBAAkBQ,YAClC,QAID,GAAIG,YAAaH,YAAYI,MAC7B,OAAOpB,uBAAsBqB,UAAUF,WAAYH,aACjDM,KAAK,SAASC,2BACdzB,OAAOM,SAASG,wBAA0BgB,0BAC1CzB,QAAOM,SAASI,gBAAkBQ,YAClCf,eAAc,cAAgBe,YAAYlD,GAC1C,OAAOyD,6BAIVzB,QAAO0B,mBAAqB,WAC3B,MAAOzB,2BAA0ByB,qBAC/BF,KAAK,SAASG,KACd,MAAOA,OAIV3B,QAAO4B,UAAY,WAClB5E,QAAQC,IAAI,mBAEZgD,2BAA0B4B,2BAG3B7B,QAAO8B,cAAgB,WACtB,GAAI9B,OAAOM,UAAY,KAAM,CAC5B,OAGDN,OAAOM,SAASC,YAAcP,OAAOM,SAASC,kBAMnD9E,SAAQC,OAAO,cACZuZ,QAAQ,0BAA2B,WAClC,YAEA,SAASC,wBAAuB/S,MAAOO,QACrCiD,KAAKxD,MAAQA,KACbwD,MAAKjD,OAASA,OAGhB,GAAIyS,OAAQD,uBAAuBE,SAEnC,SAASC,UAASlT,MAAOO,OAAQ4S,YAC/B,MAAO3W,MAAK4W,KAAKD,YAAcnT,MAAQO,SAGzC,QAAS8S,YAAWrT,MAAOO,OAAQkR,GACjC,MAAQzR,OAAQO,OAAUkR,EAG5B,QAAS6B,YAAWtT,MAAOO,OAAQiR,GACjC,MAAQjR,QAASP,MAASwR,EAG5B,QAAS+B,oBAAmB/B,EAAGC,GAC7B,MAAOjV,MAAK4W,KAAM5B,EAAIA,EAAMC,EAAIA,GAGlCuB,MAAMQ,eAAiB,SAAUC,eAC/B,GAAIA,gBAAkB,EAAG,CACvB,OAAQ,EAAG,GAGb,GAAI/E,OAAQwE,SAAS1P,KAAKxD,MAAOwD,KAAKjD,OAAQkT,cAC9C,IAAIC,kBAAmBlQ,KAAKxD,MAAQ0O,KACpC,IAAIiF,kBAAmBnQ,KAAKjD,OAASmO,KAErC,IAAIkF,QAASpX,KAAKqX,KAAKH,iBACvB,IAAII,QAAStX,KAAKqX,KAAKF,iBAEvB,IAAII,YAAaT,WAAW9P,KAAKxD,MAAOwD,KAAKjD,OAAQqT,OACrD,IAAII,UAAWT,mBAAmBK,OAAQG,WAE1C,IAAIE,YAAaZ,WAAW7P,KAAKxD,MAAOwD,KAAKjD,OAAQuT,OACrD,IAAII,UAAWX,mBAAmBU,WAAYH,OAE9C,IAAIK,WAAY,WACd,GAAID,SAAWF,SAAU,CACvB,OAAQJ,OAAQpX,KAAK4D,MAAMuT,uBACtB,IAAIK,SAAWE,SAAU,CAC9B,OAAQ1X,KAAK4D,MAAMsT,kBAAmBI,QAExC,OAAQtX,KAAKqX,KAAKH,kBAAmBlX,KAAKqX,KAAKF,mBAGjD,IAAIjY,QAASyY,WACb,IAAIzY,OAAO,GAAKA,OAAO,GAAK+X,cAAe,CACzC,OAAQG,OAAQE,QAElB,MAAOpY,QAIT,OAAOqX,0BAEXzZ,SAAQC,OAAO,cACZC,UAAU,2BAA4B,yBAA0B,SAASuZ,wBACxE,YACA,QACEtZ,YAAa;AACbC,SAAU,IACVC,KAAM,QAASC,UAASC,MAAQC,SAC9B,GAAIsa,YAAa,gBACjB,IAAIC,OAAQ,EACZ,IAAIC,QAAS,EAEbza,OAAMI,OAAOC,aAAeC,EAAEC,KAAKP,MAAMI,OAAOC,aAAc,eAC9D,IAAIqa,0BAA2B1a,MAAMI,OAAOC,aAAakT,OAAO,SAASzQ,GACvE,MAAOA,GAAE+F,iCACR8R,KAAK,SAASC,GACf,MAAOA,GAAEhS,wBAA0B,IAAM,KAE3C5I,OAAM6a,YAAcH,yBAAyB/Z,MAC7C,IAAIma,gCAAiCJ,yBAAyBnH,OAAO,SAASzQ,GAC5E,MAAOA,GAAE8F,wBAEX5I,OAAM+a,UAAYD,+BAA+Bna,MACjDX,OAAMgb,KAAOrY,KAAKqX,KAAKrX,KAAK4W,KAAKvZ,MAAM6a,aACvC,IAAI7a,MAAMgb,OAAS,EAAG,CACpB,OAKF,GAAIC,WAAY,GAAI/B,wBAAuBsB,MAAOC,OAClD,IAAIS,YAAaD,UAAUtB,eAAe3Z,MAAM6a,YAChD,IAAIM,iBAAkBD,WAAW,EACjC,IAAIE,cAAeF,WAAW,EAE9B,IAAIG,UAAW,CAEf,IAAIC,kBAAmBH,gBAAkBE,QACzC,IAAIE,mBAAoBH,aAAeC,QAEvC,IAAIvQ,UAAW0P,MAAQc,kBAAoB,IAAMb,OAASc,mBAAqB,GAC/Evb,OAAMoU,KAAOrN,GAAGC,OAAO/G,QAAQ,IAAI+G,OAAOuT,WAC1Cva,OAAMwb,UAAYxb,MAAMoU,KAAKnN,OAAO,KACjCC,KAAK,QAAS,iBACdA,KAAK,YAAa,aAAe4D,OAAO,GAAK,KAAOA,OAAO,GAAK,IAEnE9K,OAAMwb,UAAUhU,UAAU,UACvBC,KAAKiT,0BACLhT,QACAT,OAAO,UACPC,KAAK,cAAelH,MAAM6a,aAC1B3T,KAAK,aAAciU,iBACnBjU,KAAK,cAAekU,cACpBlU,KAAK,KAAM,SAASS,EAAGW,OACtB,GAAImT,WAAcnT,MAAQ6S,iBAAoBE,SAAW,EAEzD,OAAOI,aAERvU,KAAK,KAAM,SAASS,EAAGW,OACtB,GAAIoT,WAAY/Y,KAAK4D,MAAM+B,MAAQ6S,kBAAoBE,SAAW,EAClE,OAAOK,aAERxU,KAAK,IAAKmU,SAAW,IACrBnU,KAAK,QAAS,SAASS,GACtB,MAAOA,GAAEiB,uBAAyB,YAAc,oBAO5DnJ,SAAQC,OAAO,cACZC,UAAU,sBAAuB,WAChC,YACA,QACEC,YAAa,4DACbC,SAAU,IACVC,KAAM,QAASC,UAASC,OACtBA,MAAMI,OAAOC,aAAeC,EAAEC,KAAKP,MAAMI,OAAOC,aAAc,eAC9D,IAAIqa,0BAA2B1a,MAAMI,OAAOC,aAAakT,OAAO,SAASzQ,GACvE,MAAOA,GAAE+F,gCAEX7I,OAAM6a,YAAcH,yBAAyB/Z,MAC7C,IAAIma,gCAAiCJ,yBAAyBnH,OAAO,SAASzQ,GAC5E,MAAOA,GAAE8F,wBAEX5I,OAAM+a,UAAYD,+BAA+Bna,WAYzDlB,SAAQC,OAAO,cACVuZ,QAAQ,6BAA8B,iBAAkB,wBAAyB,gCAC9E,SAAS0C,eAAgBzX,sBAAuB0X,+BAC5C,YACA,IAAIC,6BAA8B,iBAClC,IAAIC,oBAAqB,UACzB,IAAIC,mBAAoB,SACxB,IAAI9X,2BAA4B,WAC5B0X,eAAe7E,KAAKnN,KACpBA,MAAKqS,WAGT,IAAI7C,OAAQlV,0BAA0BmV,UAAY6C,OAAOC,OAAOP,eAAevC,UAE/ED,OAAMtT,yBAA2B,WAC7B,GAAIsW,KAAMN,2BACVlS,MAAKyS,MAAM/Q,OAAOwQ,6BAGtB1C,OAAMzT,mBAAqB,WACvB,GAAIyW,KAAMN,2BACV,IAAIlS,KAAKyS,MAAMC,IAAIF,KAAM,CACrBnb,QAAQC,IAAI,iBACZ,OAAO0I,MAAKyS,MAAMC,IAAIF,KAG1B,GAAIG,SAAU3S,KAAK4S,UAAW,yCACzB/W,KAAK,SAASgX,gBACX,GAAIxH,OAAQyH,SAASC,QAAQF,eAAgBA,eAAeG,QAAQ3H,MACpE,IAAIgB,SAAUyG,SAASC,QAAQF,eAAgBA,eAAeG,QAAQna,OACtE,IAAIsT,UAAW2G,SAASC,QAAQF,eAAgBA,eAAeG,QAAQ/a,OACvE,IAAI8B,SAAU+Y,SAASC,QAAQF,eAAgBA,eAAeG,QAAQC,iBAEtE,IAAIC,WAAYvc,EAAE0U,MAAM8H,UACnB1b,IAAI,SAASsb,SACV,GAAIrX,YAAa,GAAIuW,8BACrB,IAAImB,MAAOL,QAAQM,UACnB3X,YAAWrD,GAAK+a,KAAKE,GACrB5X,YAAW4N,KAAO8J,KAAK9J,IACvB5N,YAAW6X,iBAAmBpY,GAC9BO,YAAWsR,UAAYoG,KAAKI,UAC5B9X,YAAW+X,kBAAoBtY,GAC/BO,YAAWC,OAAS,IACpBD,YAAW2N,KAAO,OAClB3N,YAAW5C,WACX4C,YAAW4P,SAAWyH,OACtB,OAAOrX,cAEVgY,QAAQ,MACRhF,OAEL,IAAIiF,YAAahd,EAAE0V,QAAQ8G,UACtB1b,IAAI,SAASsb,SACV,GAAIxX,aAAc,GAAI0W,8BACtB1W,aAAYyR,UAAY+F,QAAQM,WAAW/J,IAC3C/N,aAAYlD,GAAK0a,QAAQM,WAAWC,GACpC/X,aAAY+N,KAAOyJ,QAAQM,WAAW/J,IACtC/N,aAAY+P,SAAWyH,OACvBxX,aAAY8N,KAAO,QACnB,OAAO9N,eAEVqY,OAAO,QACPF,QAAQ,MACRhF,OAEL,IAAImF,YAAald,EAAEwV,SAASgH,UACvBvJ,OAAO,SAASmJ,SACb,MAAOA,SAAQM,WAAWtE,aAAe,IAE5CtX,IAAI,SAASsb,SACV,GAAIe,aAAc,GAAI7B,8BACtB,IAAIoB,YAAaN,QAAQM,UACzBS,aAAYzb,GAAKgb,WAAWC,GAC5BQ,aAAYxK,KAAO+J,WAAW/J,IAC9BwK,aAAYxI,SAAWyH,OACvBpc,GAAEod,OAAOD,YAAaT,WACtBS,aAAYzK,KAAO,QACnB,OAAOyK,eAEVF,OAAO,QACPF,QAAQ,MACRhF,OAEL,IAAIsF,gBAAiBrd,EAAEkd,YAClBI,QAAQ,aACRvF,OAGL,IAAIwF,WAAYhB,UAAU,KAC1B,IAAIiB,eAAgBxd,EAAEgd,YACjBM,QAAQ,WACL,MAAOC,WAAU7b,KAEpBqW,OAEL,IAAI0F,YAAazd,EAAEoD,QAAQoZ,UACtB1b,IAAI,SAASsb,SACV,GAAIsB,aAAc,GAAIpC,8BACtB,IAAIoB,YAAaN,QAAQM,UACzBgB,aAAYhc,GAAKgb,WAAW1F,EAC5B0G,aAAY/K,KAAO+J,WAAW1b,IAC9B0c,aAAY/I,SAAWyH,OACvBsB,aAAYZ,kBAAoBJ,WAAWiB,iBAC3CD,aAAYd,iBAAmBF,WAAWkB,gBAC1C5d,GAAEod,OAAOM,YAAahB,WAEtBgB,aAAYhL,KAAO,gBACnB,OAAOgL,eAEVT,OAAO,QACPF,QAAQ,MACRhF,OAEL/X,GAAE8H,QAAQyU,UAAW,SAAS7H,OAC1B,GAAImJ,SAAUnJ,MAAMhT,EACpB,IAAIgU,SAAU8H,cAAcK,QAC5BnJ,OAAMvS,SAAWuT,OAEjB1V,GAAE8H,QAAQ4M,MAAMvS,SAAU,SAASD,QAC/B,GAAI+R,UAAW/R,OAAOR,EACtB,IAAI8T,UAAW6H,eAAepJ,SAC9B/R,QAAOC,SAAWqT,QAClBtT,QAAO8C,OAAS0P,KAChB1U,GAAE8H,QAAQ5F,OAAOC,SAAU,SAASpB,GAChCA,EAAEiE,OAAS9C,YAOvBlC,GAAE8H,QAAQ2V,WAAY,SAAS3d,QAC3BE,EAAE8H,QAAQhI,OAAOe,SAAU,SAASid,mBAChC,GAAIX,aAAcD,WAAWY,kBAAkB9G,GAC/CmG,aAAYhb,SAASO,KAAK5C,WAKlCuJ,MAAKqS,UACL,OAAOa,YAET1G,KAAKxM,MACXA,MAAKyS,MAAMiC,IAAIlC,IAAKG,QACpB,OAAOA,SAGXrY,2BAA0BmV,UAAYD,KACtC,OAAO,IAAIlV,6BAGvB,aASAxE,SAAQC,OAAO,cACZuZ,QAAQ,gCAAiC,WACxC,QAAS2C,iCACLjS,KAAKzH,OAGT0Z,8BAA8BxC,WAC5BpX,GAAI,KACJiR,KAAM,GACN0D,UAAW,GACX1B,SAAU,KACViI,iBAAkBpY,IAClBsY,kBAAmBtY,IACnBkO,KAAM,KACN1N,OAAQ,KACR7C,YAEAP,KAAM,WACJyH,KAAK3H,GAAK,IACV2H,MAAKsJ,KAAO,EACZtJ,MAAKgN,UAAY,EACjBhN,MAAKsL,SAAW,IAChBtL,MAAKyT,kBAAoBtY,GACzB6E,MAAKuT,iBAAmBpY,GACxB6E,MAAKrE,OAAS,IACdqE,MAAKlH,aAKT,OAAOmZ,gCAGX,aASAnc,SAAQC,OAAO,cACZuZ,QAAQ,kCAAA,iBAAA,gCAAkC,SAAUqF,eAAgB1C,+BACnE,QAAS2C,gCAA+B9W,MACpC6W,eAAexH,KAAKnN,KAAMlC,MAI9B,GAAI0R,OAAQoF,+BAA+BnF,UAAY6C,OAAOC,OAAOoC,eAAelF,UACpFmF,gCAA+BnF,UAAUoF,YAAcD,8BAMvDpF,OAAM/V,MAAQwY,6BAEd,OAAO2C,kCAGX,aASA9e,SAAQC,OAAO,cACZuZ,QAAQ,2BAAA,wBAAA,4BAAA,KAA2B,SAAU/U,sBAAuBD,0BAA2BoO,IAC9F,GAAIoM,yBAA0B,YAI9B,IAAItF,QACHuF,WAAY,WACX,MAAOza,2BAA0ByB,qBAC/BF,KAAK,SAASuQ,QACd/U,QAAQC,IAAI,aAIf0d,SAAU,SAASC,UACZ,MAAO,QAGdC,YAAa,SAAStK,UACf,MAAO,OAGduK,cAAe,SAASvK,UACjB,MAAO,OAGXhP,UAAW,SAASgP,UAChB,GAAI5K,KAAKgV,WAAY,IAQ7BF,yBAAwBrF,UAAYD,KACpC,OAAO,IAAIsF,2BAGf,aAEA,IAAIM,kBAAmB,QACvB,IAAIC,WAAY,SAASb,QAAS5J,UACjC,MAAOwK,kBAAmB,IAAMZ,QAAU,IAAM5J,SASjD9U,SAAQC,OAAO,cACZuZ,QAAQ,yBAA0B,iBAAkB,mBAAoB,gCACxE,SAAU0C,eAAgBsD,iBAAkBrD,+BAC3C,GAAI1X,uBAAwB,WACxByX,eAAe7E,KAAKnN,MAGxB,IAAIwP,OAAQjV,sBAAsBkV,UAAY6C,OAAOC,OAAOP,eAAevC,UAE3ED,OAAM5T,UAAY,SAASF,WAAYH,aACzC,GAAIG,YAAc,MAAQA,WAAWsR,WAAa,KAAM,CACvD,KAAM,IAAIxR,OAAM,wBAGjB,GAAID,aAAe,MAAQA,YAAYyR,WAAa,KAAM,CACzD,KAAM,IAAIxR,OAAM,yBAGjB,GAAIgZ,SAAU9Y,WAAWsR,SACzB,IAAIpC,UAAWrP,YAAYyR,SAC3B,IAAIuI,WAAYF,UAAUb,QAAS5J,SAE7B,IAAI5K,KAAKyS,MAAMC,IAAI6C,WAAY,CAC3Ble,QAAQC,IAAI,iBACZ,OAAO0I,MAAKyS,MAAMC,IAAI6C,WAGhC,GAAI5C,SAAU2C,iBAAiB1Z,UAAU4Y,QAAS5J,UAChD/O,KAAK,SAASyP,UACdjU,QAAQC,IAAI,WAAYgU,SACxB,OAAOA,WAGHtL,MAAKyS,MAAMiC,IAAIa,UAAW5C,QAC7B,OAAOA,SAGRpY,uBAAsBkV,UAAYD,KAClC,OAAO,IAAIjV,yBAGf,aACA,IAAIib,YAAa,SAAShB,QAAS5J,UACjC,MAAO4J,SAAU,IAAM5J,SAAW,aASpC9U,SAAQC,OAAO,cACZuZ,QAAQ,oBAAqB,iBAAkB,SAAS0C,gBACvD,GAAIsD,kBAAmB,WACrBtD,eAAe7E,KAAKnN,KACpBA,MAAKqS,WAGP,IAAI7C,OAAQ8F,iBAAiB7F,UAAY6C,OAAOC,OAAOP,eAAevC,UAEtED,OAAM5T,UAAY,SAAS4Y,QAAS5J,UAClC,GAAI4J,SAAW,KAAM,CACnB,KAAM,IAAIhZ,OAAM,0BAGlB,GAAIoP,UAAY,KAAM,CACpB,KAAM,IAAIpP,OAAM,2BAGlB,GAAI+I,MAAOiR,WAAWhB,QAAS5J,SAC/B,OAAO5K,MAAK4S,UAAW,eAAiBrO,MAG1C+Q,kBAAiB7F,UAAYD,KAC7B,OAAO,IAAI8F,oBAEf,aASAxf,SAAQC,OAAO,cACZuZ,QAAQ,uBAAwB,WAC3B,GAAI9V,sBAAuB,SAASic,YAAaC,kBAC7C1V,KAAKyV,YAAc,CACnBzV,MAAK0V,iBAAmB,CACxB1V,MAAKzH,KAAKkd,YAAaC,kBAG3B,IAAIlG,OAAQhW,qBAAqBiW,SAEjCD,OAAMjX,KAAO,SAASkd,YAAaC,kBAC/B,GAAID,aAAe,MAAQC,iBAAmB,EAAG,CAC7C,KAAM,IAAIla,OAAM,6CAGpB,GAAIka,kBAAoB,MAAQA,iBAAmB,EAAG,CAClD,KAAM,IAAIla,OAAM,8CAGpB,GAAIka,iBAAmBD,YAAa,CAKhCC,iBAAmBD,YAGvBzV,KAAKyV,YAAcA,WACnBzV,MAAK0V,iBAAmBA,gBAExB,IAAIC,yBAA0B,SAAS3e,QACnC,GAAI4e,MAAO5c,KAAK4W,KAAK5Y,OAASgC,KAAK6c,GACnC,OAAOD,MAGX5V,MAAK8V,YAAcH,wBAAwB3V,KAAKyV,YAGhD,IAAIM,oCAAqC/V,KAAK0V,iBAAmB1V,KAAKyV,WACtEzV,MAAKgW,iBAAmBhW,KAAK8V,YAAcC,mCAG/C,OAAOvc,uBAGf,aASA1D,SAAQC,OAAO,cACZuZ,QAAQ,oBAAqB,aAAc,gBAAiB,QAAS,KAAM,WAC1E,SAASlQ,WAAY6W,cAAeC,MAAOxN,GAAIC,UAC7C,QAAS5Q,qBAITA,iBAAiB0X,WACf0G,WAAY,WACV,GAAIC,UAAW1N,GAAG2N,OAElB1N,UAAS,WACP,GAAI2N,aAAcJ,MAAMxD,IAAI,oCACzB7W,KAAK,SAAS0a,UACb,MAAOA,UAASzY,MAGpBsY,UAASI,QAAQF,cAChB,IAEH,OAAOF,UAASzD,SAGlBoC,WAAY,WAMV,GAAIqB,UAAW1N,GAAG2N,OAElB1N,UAAS,WACP,GAAI2N,aAAcJ,MAAMxD,IAAI,6BACzB7W,KAAK,SAAS0a,UACb,MAAOA,UAASzY,MAGpBsY,UAASI,QAAQF,cAChB,IAEH,OAAOF,UAASzD,SAIpB,OAAO,IAAI5a,oBAGjB,aASAjC,SAAQC,OAAO,cACZuZ,QAAQ,2BAA4B,WACnC,GAAImH,qBAAsB,SAAUC,YAAana,eAC7CyD,KAAK0W,YAAc,IACnB1W,MAAKlD,QAAU,CACfkD,MAAKxD,MAAQ,CACbwD,MAAKzH,KAAKme,YAAana,eAG3Bka,qBAAoBhH,UAAUlX,KAAO,SAASme,YAAana,eACzDyD,KAAK0W,YAAcA,WACnB,IAAIC,MAAOD,YAAYE,KAAOra,aAC9B,IAAIsa,OAAQH,YAAYI,MAAQva,aAChCyD,MAAKlD,QAAU,EAAM6Z,IACrB3W,MAAKxD,MAAQxD,KAAK+d,IAAIJ,KAAOE,OAG/B,OAAOJ,sBAGX,aASA3gB,SAAQC,OAAO,cACZuZ,QAAQ,sBAAuB,aAAc,gBAAiB,QAAS,KAAM,WAC5E,SAAUlQ,WAAY6W,cAAeC,MAAOxN,GAAIC,UAChD,QAASF,uBAITA,mBAAmBgH,WACjBuH,oBAAqB,WACnB,GAAIZ,UAAW1N,GAAG2N,OAEhB1N,UAAS,WACP,GAAI2N,aAAcJ,MAAMxD,IAAI,8BAC3B7W,KAAK,SAAS0a,UACb,MAAOA,UAASzY,MAGlBsY,UAASI,QAAQF,cAChB,IAEH,OAAOF,UAASzD,SAItB,OAAO,IAAIlK,sBAGf,aASA3S,SAAQC,OAAO,cACZuZ,QAAQ,YAAa,WACpB,QAAS2H,WAAUC,MACf,GAAIA,KAAM,CACNlX,KAAKmX,UAAUD,OAKvBD,UAAUxH,WACNoF,YAAaoC,UAKbE,UAAW,SAASD,MAChB,GAAI1E,IACJ,KAAKA,MAAO0E,MAAM,CACd,GAAIA,KAAKE,eAAe5E,KAAM,CAC1BxS,KAAKwS,KAAO0E,KAAK1E,QAS7B6E,OAAQ,WACJ,GAAIC,QACJ,IAAI9E,IACJ,KAAKA,MAAOxS,MAAM,CACd,GAAIA,KAAKoX,eAAe5E,YAAexS,MAAKwS,OAAS,WAAY,CAC7D8E,KAAK9E,KAAOxS,KAAKwS,MAIzB,MAAO8E,OAGXC,QAAS,WACL,GAAI/E,IACJ,KAAKA,MAAOxS,MAAM,CACd,GAAIA,KAAKoX,eAAe5E,KAAM,OACnBxS,MAAKwS,QAM5ByE,WAAUO,qBAAuB,SAAS/d,OACtC,MAAOA,OAAM4P,KAGjB,OAAO4N,YAGX,aASAnhB,SAAQC,OAAO,cACZuZ,QAAQ,kBAAA,YAAkB,SAAU2H,WACnC,QAAStC,gBAAe8C,aACpBzX,KAAK0X,UACL,IAAID,YAAa,CACbzX,KAAK2X,QAAQF,cAKrB9C,eAAelF,WAKXhW,MAAOwd,UACPpC,YAAaF,eAKb+C,QAAS,KAKT1gB,OAAQ,EAMRqgB,OAAQ,WACJ,MAAOrX,MAAKvI,IAAI,SAASgC,OACrB,MAAOA,OAAM4d,YAIrBO,QAAS,WACL,MAAO5X,MAAK0X,QAAQ5Q,SAGxByQ,QAAS,WACLvX,KAAKU,KAAK,SAASjH,OACfA,MAAM8d,WAEVvX,MAAK0X,QAAQ1gB,OAAS,CACtBgJ,MAAK0X,QAAU,MASnBG,KAAM,SAASC,kBACX,GAAIA,iBAAkB,CAClB,MAAO,IAAI9X,MAAK6U,YAAYiD,kBAGhC,MAAO,IAAI9X,MAAK6U,YAAY7U,KAAK0X,UAQrCC,QAAS,SAASI,WACd,GAAI5e,EACJ,IAAI6e,KAAMD,UAAU/gB,MACpB,KAAKmC,EAAI,EAAGA,EAAI6e,IAAK7e,IAAK,CACtB6G,KAAKiY,IAAIF,UAAU5e,MAS3B8e,IAAK,SAASF,WACV,GAAIG,cACJ,MAAMH,oBAAqB/X,MAAKvG,OAAQ,CACpCye,cAAgB,GAAIlY,MAAKvG,MAAMse,eAC5B,CACHG,cAAgBH,UAGpB/X,KAAK0X,QAAQre,KAAK6e,cAClBlY,MAAKhJ,QACL,OAAOgJ,MAAKhJ,QAShB0K,OAAQ,SAASyW,eACb,GAAI1e,MAEJ,IAAI2e,sBAAuBD,aAC3B,IAAIC,+BAAgCpY,MAAKvG,MAAO,CAC5CA,MAAQuG,KAAKqY,eAAeD,0BACzB,CACH3e,MAAQuG,KAAKsY,YAAYF,sBAG7B,GAAI3e,OAASA,SAAW,EAAG,CACvBuG,KAAKhJ,SAGT,MAAOgJ,MAAKhJ,QAOhBuhB,MAAO,WACHvY,KAAK0X,QAAQ1gB,OAAS,CACtBgJ,MAAKhJ,OAAS,GAQlBkN,MAAO,WACH,MAAOlE,MAAK0X,QAAQ,IAQxB1G,KAAM,SAASwH,QACXxY,KAAK0X,QAAQ1G,KAAKwH,SAStB5E,OAAQ,SAASpB,IAAKiG,UAClBzY,KAAKgR,KAAK,SAAS0H,OAAQC,QACvB,GAAI1H,GAAIyH,OAAOlG,IACf,IAAIjH,GAAIoN,OAAOnG,IAEf,IAAIiG,SAAU,CACV,MAAOxH,GAAI1F,GAAK,EAAI0F,EAAI1F,EAAI,EAAI,MAC7B,CACH,MAAO0F,GAAI1F,GAAK,EAAI0F,EAAI1F,EAAI,EAAI,MAa5CqN,WAAY,SAASpG,IAAKiG,SAAUpP,MAChC,GAAIA,OAAS,SAAU,CACnBrJ,KAAK6Y,aAAarG,IAAKiG,SAAU,UAC9B,IAAIpP,OAAS,cAAe,CAC/BrJ,KAAK8Y,YAAYtG,IAAKiG,cACnB,IAAIpP,OAAS,SAAU,CAC1BrJ,KAAK+Y,aAAavG,IAAKiG,cACpB,CACHzY,KAAK4T,OAAOpB,IAAKiG,YAazBI,aAAc,SAASrG,IAAKiG,SAAUO,cAClChZ,KAAKgR,KAAK,SAAS0H,OAAQC,QACvB,GAAI1H,GAAIyH,OAAOlG,IACf,IAAIjH,GAAIoN,OAAOnG,IAEf,IAAIwG,aAAc,CACd/H,EAAIA,EAAEgI,aACN1N,GAAIA,EAAE0N,cAGV,GAAIR,SAAU,CACV,MAAOxH,GAAI1F,GAAK,EAAI0F,EAAI1F,EAAI,EAAI,MAC7B,CACH,MAAO0F,GAAI1F,GAAK,EAAI0F,EAAI1F,EAAI,EAAI,MAc5CuN,YAAa,SAAStG,IAAKiG,UACvBzY,KAAKgR,KAAK,SAAS0H,OAAQC,QACvB,GAAI1H,GAAIyH,OAAOlG,KAAOkG,OAAOlG,KAAKxb,OAAS,CAC3C,IAAIuU,GAAIoN,OAAOnG,KAAOmG,OAAOnG,KAAKxb,OAAS,CAE3C,IAAIyhB,SAAU,CACV,MAAOxH,GAAI1F,GAAK,EAAI0F,EAAI1F,EAAI,EAAI,MAC7B,CACH,MAAO0F,GAAI1F,GAAK,EAAI0F,EAAI1F,EAAI,EAAI,MAc5CwN,aAAc,SAASvG,IAAKiG,UACxBzY,KAAKgR,KAAK,SAAS0H,OAAQC,QACvB,GAAI1H,GAAIyH,OAAOlG,KAAOkG,OAAOlG,KAAO,CACpC,IAAIjH,GAAIoN,OAAOnG,KAAOmG,OAAOnG,KAAO,CAEpC,IAAIiG,SAAU,CACV,MAAOxH,GAAI1F,GAAK,EAAI0F,EAAI1F,EAAI,EAAI,MAC7B,CACH,MAAO0F,GAAI1F,GAAK,EAAI0F,EAAI1F,EAAI,EAAI,MAU5CmH,IAAK,SAASra,IACV,GAAIc,GAAI,CACR,IAAI6e,KAAMhY,KAAK0X,QAAQ1gB,MACvB,MAAOmC,EAAI6e,IAAK7e,IAAK,CAIjB,GAAI6G,KAAK0X,QAAQve,GAAGd,IAAMA,GAAI,CAC1B,MAAO2H,MAAK0X,QAAQve,MAUhC+f,GAAI,SAASva,OACT,MAAOqB,MAAK0X,QAAQ/Y,QASxBwa,QAAS,SAASC,WAAYC,SAC1B,GAAIC,YAAaD,SAAWD,WAAa,EACzC,IAAIG,UAAWD,WAAaD,OAE5B,IAAIC,WAAatZ,KAAK0X,QAAQ1gB,OAAS,EAAG,CACtC,SAGJ,MAAOgJ,MAAK0X,QAAQ5Q,MAAMwS,WAAYC,WAG1CC,SAAU,SAASnhB,IACf,GAAIc,EACJ,IAAI6e,KAAMhY,KAAKhJ,MACf,KAAKmC,EAAI,EAAGA,EAAI6e,IAAK7e,IAAK,CACtB,GAAI6G,KAAK0X,QAAQve,GAAGd,KAAOA,GAAI,CAC3B,MAAO,OAGf,MAAO,QAeXohB,MAAO,SAASC,iBACZ,GAAIC,KACJ,IAAIC,QACJ,IAAIC,MAGJ,IAAI7Z,KAAK6U,cAAgB6E,gBAAgB7E,YAAa,CAClD,SAGJ8E,KAAO3Z,IACP4Z,WACAC,SAGA7Z,MAAKU,KAAK,SAASpK,QAASqI,OACxB,IAAK+a,gBAAgBF,SAASljB,QAAQ+B,IAAK,CACvC2H,KAAK0B,OAAOpL,QAAQ+B,GACpBuhB,SAAQvgB,KAAK/C,QAAQ+B,MAK7BqhB,iBAAgBhZ,KAAK,SAASpK,QAASqI,OACnC,IAAKqB,KAAKwZ,SAASljB,QAAQ+B,IAAK,CAC5B2H,KAAKiY,IAAI3hB,QACTujB,OAAMxgB,KAAK/C,QAAQ+B,MAI3B,QACIuhB,QAAWA,QACXC,MAASA,QAUjBvB,YAAa,SAASjgB,IAClB,GAAI2f,KAAMhY,KAAKhJ,MACf,IAAImC,EAEJ,KAAKA,EAAI,EAAGA,EAAI6e,IAAK7e,IAAK,CACtB,GAAI6G,KAAK0X,QAAQve,GAAGd,KAAOA,GAAI,CAC3B,MAAO2H,MAAK0X,QAAQtQ,OAAOjO,EAAG,MAU1Ckf,eAAgB,SAAS5e,OACrB,GAAIue,KAAMhY,KAAKhJ,MACf,IAAImC,EAEJ,KAAIA,EAAI,EAAGA,EAAI6e,IAAK7e,IAAK,CACrB,GAAI6G,KAAK0X,QAAQve,KAAOM,MAAO,CAC3B,MAAOuG,MAAK0X,QAAQtQ,OAAOjO,EAAG,MAQ9C,IAAI2gB,UACA,UACA,OACA,MACA,SACA,OACA,SACA,UAGJnjB,GAAE+J,KAAKoZ,QAAS,SAASC,QACrBpF,eAAelF,UAAUsK,QAAU,WAC/B,GAAIC,MAAOC,MAAMxK,UAAU3I,MAAMqG,KAAK+M,UACtCF,MAAK1S,QAAQtH,KAAK0X,QAClB,OAAO/gB,GAAEojB,QAAQhT,MAAMpQ,EAAGqjB,QASlCrF,gBAAewF,MAEXC,MACIC,aAAc,cACdC,OAAQ,SACRC,KAAM,OACNC,OAAQ,UAIhB,OAAO7F,kBAGX,aAYA7e,SAAQC,OAAO,cACZuZ,QAAQ,kBAAmB,aAAc,gBAAiB,QAAS,KAAM,WACxE,SAAUlQ,WAAY6W,cAAeC,MAAOxN,GAAIC,UAChD,GAAI8R,gBAAiBpa,OAAOoa,cAC5B,IAAIC,kBAAmB,GACvB,IAAIC,aAAc1E,cAAc,KAEhC,SAASjE,kBACLhS,KAAKyS,MAAQkI,YAGjB3I,eAAevC,WACbgD,MAAO,KACPmI,WAAY,WACRD,YAAYE,aAGhBxI,SAAU,WACR,GAAIyI,MAAO9a,KAAKyS,MAAMqI,MACtBzjB,SAAQC,IAAI,QAASwjB,OAGvBlI,OAAQ,SAAS9U,KAAMid,SAAUtI,OAC/BA,MAAQ,KAER,IAAIuI,SACAC,IAAKjJ,eAAekJ,cAAgBH,SACpCI,OAAQrd,KACR2U,MAAOA,MACPsH,OAAQ,MAGZ,IAAI3D,UAAW1N,GAAG2N,OAEhB1N,UAAS,WACP,GAAI2N,aAAcJ,MAAM8E,QACrBnf,KAAK,SAAS0a,UACX,GAAIA,UAAYA,SAASzY,MAAQyY,SAASzY,KAAKsd,cAAe,CAC1D,MAAO1S,IAAG2S,OAAO9E,SAASzY,MAG9B,MAAOyY,UAASzY,OACjBwd,MAAM,SAASC,QAEd,MAAO7S,IAAG2S,OAAOE,SAGvBnF,UAASI,QAAQF,cAChBoE,iBAEH,OAAOtE,UAASzD,SAItBX,gBAAekJ,cAAgB,EAE/B,OAAOlJ,oBAGX,WACE,YAEAlc,SACGC,OAAO,cACPylB,IAAIC,SAGP,SAASA,UAASC,MAEhBA,KAAKC,MAAM,gBAEbF,SAASG,SAAW,aAGtB,WACE,YAEA9lB,SACGC,OAAO,cACPilB,OAAOa,aAGV,SAASA,cAAaC,eAAgBC,oBACpCD,eACGzQ,MAAM,QACL4P,IAAK,IACLhlB,YAAa,wBACbmE,WAAY,iBACZ4hB,aAAc,QAGlBD,oBAAmBE,UAAU,KAG/BJ,aAAaD,SAAW,iBAAkB,2BAE5C,WACE,YAEA9lB,SACGC,OAAO,mBAMZ,WACE,YAEAD,SACGC,OAAO,cACPilB,OAAOA,OAGV,SAASA,QAAOkB,cAEdA,aAAaC,aAAa,MAI5BnB,OAAOY,SAAW,mBACpB9lB,SAAQC,OAAO,cAAcylB,KAAK,iBAAkB,SAASY,gBAAiBA,eAAe1H,IAAI,iEAAiE,4LAClK0H,gBAAe1H,IAAI,4DAA4D,kLAC/E0H,gBAAe1H,IAAI,wBAAwB,qGAC3C0H,gBAAe1H,IAAI,sCAAsC,uJACzD0H,gBAAe1H,IAAI,qDAAqD,scACxE0H,gBAAe1H,IAAI,qDAAqD,gSACxE0H,gBAAe1H,IAAI,oDAAoD,wtEACvE0H,gBAAe1H,IAAI,4CAA4C,qCAC/D0H,gBAAe1H,IAAI,4CAA4C,wMAC/D0H,gBAAe1H,IAAI,8CAA8C,mZACjE0H,gBAAe1H,IAAI,qDAAqD,wZACxE0H,gBAAe1H,IAAI,qDAAqD,uZACxE0H,gBAAe1H,IAAI,qEAAqE,m5BACxF0H,gBAAe1H,IAAI,+DAA+D","file":"scripts/app-0dcd9750a8.js","sourcesContent":["(function() {\n  'use strict';\n  angular.module('fsm', []);\n  angular\n    .module('troutSpotr', ['ui.router', 'fsm', 'infinite-scroll']);\n\n})();\n\n'use strict';\n\n/**\n * @ngdoc directive\n * @name troutDashApp.directive:StreamListItemDirective\n * @description\n * # StreamListItemDirective\n */\nangular.module('troutSpotr')\n  .directive('streamListItemDirective', function() {\n    return {\n      templateUrl: 'app/ui/streamList/streamListItem/streamlistitemtemplate.html',\n      restrict: 'A',\n      link: function postLink(scope, element, attrs) {\n        scope.isSmall = true;\n        scope.stream.AccessPoints = _.uniq(scope.stream.AccessPoints, 'LinearOffset');\n        scope.isAlertSymbolDisplayed = function() {\n          if (scope.isSmall === false) {\n            return false;\n          }\n\n          var isRestrictions = scope.stream.Restrictions.length > 0;\n          var isMessage = scope.stream.AlertMessage != null && scope.stream.AlertMessage.length > 0;\n\n          if (isRestrictions && isMessage) {\n            return true;\n          }\n        };\n\n        scope.getAlertMessage = function() {\n          return scope.stream.AlertMessage;\n        };\n\n        scope.expand = function() {\n          scope.isSmall = !scope.isSmall;\n          console.log(scope.stream);\n        };\n\n        scope.getCounties = function() {\n          if (!scope.stream.Counties) {\n            return null;\n          }\n\n          return scope.stream.Counties.map(function(c) {\n            return c.Name;\n          }).join(',');\n        };\n\n        scope.getAlternativeNames = function() {\n          if (!scope.stream.LocalNames) {\n            return null;\n          }\n\n          if (scope.stream.LocalNames.length === 0) {\n            return '';\n          }\n\n          return 'aka ' + scope.stream.LocalNames.join(',');\n        };\n      }\n    };\n  });\n'use strict';\n\n/**\n * @ngdoc directive\n * @name troutDashApp.directive:StreamListItemDirective\n * @description\n * # StreamListItemDirective\n */\nangular.module('troutSpotr')\n  .directive('streamListItemHeader', function () {\n    return {\n      templateUrl: 'app/ui/streamList/streamListItem/StreamListItemHeaderTemplate.html',\n      restrict: 'A',\n      link: function postLink(scope, element, attrs) {\n\n      }\n    };\n  });\n\n'use strict';\n/**\n * @ngdoc directive\n * @name troutDashApp.directive:StreamListDirective\n * @description\n * # StreamListDirective\n */\nangular.module('troutSpotr')\n  .directive('countyHeader', ['StreamApiService',\n    function(StreamApiService) {\n      return {\n        //app/ui/main/main.html\n        templateUrl: 'app/ui/streamList/county/CountyHeaderTemplate.html',\n        restrict: 'A',\n        link: function postLink(scope, element, attrs) {\n          // scope.displayedStreams = [];\n\n          // scope.init = function() {\n          //   scope.clearStreams();  \n          // };\n\n          // scope.clearStreams = function() {\n          //   scope.displayedStreams = [];\n          // };\n\n          // scope.loadMoreStreams = function(numberOfStreamsToAdd) {\n          //   var numberOfDisplayedStreams = scope.displayedStreams.length;\n          //   var numberOfChildStreams = scope.county.children.length;\n\n          //   numberOfStreamsToAdd = numberOfStreamsToAdd == null ? 60 : numberOfStreamsToAdd;\n          //   var numberOfStreamsRemaining = numberOfChildStreams - numberOfDisplayedStreams;\n          //   numberOfStreamsToAdd = Math.min(numberOfStreamsRemaining, numberOfStreamsToAdd);\n          //   var finalIndex = numberOfDisplayedStreams + numberOfStreamsToAdd;\n          //   for (var i = numberOfDisplayedStreams; i < finalIndex; i++) {\n          //     var streamToInject = scope.county.children[i];\n          //     scope.displayedStreams.push(streamToInject);\n          //   }\n          // };\n\n          scope.getCountyScrollBodyId = function(county) {\n            var result = '#' + scope.getCountyId(county);\n            return result;\n          };\n\n          scope.getScrollContainer = function() {\n            return '#js-list-container';\n          };\n\n          scope.getCountyId = function(county) {\n            return 'hdr-county_' + county.id;\n          };\n\n          // scope.init();\n        }\n      };\n    }\n  ]);\n'use strict';\n/**\n * @ngdoc directive\n * @name troutDashApp.directive:StreamListDirective\n * @description\n * # StreamListDirective\n */\nangular.module('troutSpotr')\n  .directive('regionHeader', ['StreamApiService',\n    function(StreamApiService) {\n      return {\n        //app/ui/main/main.html\n        templateUrl: 'app/ui/streamList/region/RegionHeaderTemplate.html',\n        restrict: 'A',\n        link: function postLink(scope, element, attrs) {\n          scope.displayedCounties = [];\n\n          scope.init = function() {\n            scope.clearCounties();  \n          };\n\n          scope.clearCounties = function() {\n            scope.displayedCounties = [];\n          };\n\n          scope.loadMoreCounties = function(numberOfCountiesToAdd) {\n            var numberOfDisplayedCounties = scope.displayedCounties.length;\n            var numberOfChildCounties = scope.region.children.length;\n\n            numberOfCountiesToAdd = numberOfCountiesToAdd == null ? 1 : numberOfCountiesToAdd;\n            var numberOfCountiesRemaining = numberOfChildCounties - numberOfDisplayedCounties;\n            numberOfCountiesToAdd = Math.min(numberOfCountiesRemaining, numberOfCountiesToAdd);\n            var finalIndex = numberOfDisplayedCounties + numberOfCountiesToAdd;\n            for (var i = numberOfDisplayedCounties; i < finalIndex; i++) {\n              var countyToInject = scope.region.children[i];\n              scope.displayedCounties.push(countyToInject);\n            }\n          };\n\n          scope.getScrollContainer = function() {\n            return '#js-list-container';\n          };\n\n          scope.getRegionScrollBodyId = function(region) {\n            var result = '#' + scope.getRegionId(region);\n            return result;\n          };\n\n          scope.getRegionId = function(region) {\n            var result = 'hdr-region_' + region.id;\n            return result;\n          };\n\n          scope.init();\n        }\n      };\n    }\n  ]);\n'use strict';\n\n/**\n * @ngdoc directive\n * @name troutDashApp.directive:streamRatio\n * @description\n * # streamRatio\n */\nangular.module('troutSpotr')\n  .directive('streamRatio', function (StreamRatioViewModel) {\n    return {\n      templateUrl: 'app/ui/streamRatio/streamratiotemplate.html',\n      restrict: 'A',\n      link: function postLink(scope, element, attrs) {\n        var model = new StreamRatioViewModel(scope.stream.TroutStreamsLength, scope.stream.PalsLength);\n        scope.streamRatio = model;\n      }\n    };\n  });\n\n'use strict';\n/**\n * @ngdoc directive\n * @name troutDashApp.directive:StreamListDirective\n * @description\n * # StreamListDirective\n */\nangular.module('troutSpotr')\n  .directive('streamList', ['StreamApiService',\n    function(StreamApiService) {\n      return {\n        //app/ui/main/main.html\n        templateUrl: 'app/ui/streamList/streamlisttemplate.html',\n        restrict: 'A',\n        link: function postLink(scope, element, attrs) {\n          scope.stage = {\n            isLoaded: false,\n            streams: null,\n            selectedStream: null\n          };\n\n          // scope.getScrollContainer = function() {\n          //   return '#js-list-container';\n          // };\n\n          // scope.getRegionScrollBodyId = function(region) {\n          //   var result = '#' + scope.getRegionId(region);\n          //   return result;\n          // };\n\n          // scope.getRegionId = function(region) {\n          //   var result = 'hdr-region_' + region.id;\n          //   return result;\n          // };\n\n          scope.getScrollContainer = function() {\n            return '#js-list-container';\n          };\n\n          scope.$watch('stage.selectedStream', function(newSelectedStream, oldSelectedStream) {\n            if (newSelectedStream == null) {\n              return;\n            }\n          });\n        }\n      };\n    }\n  ]);\n'use strict';\n\n/**\n * @ngdoc function\n * @name troutDashApp.controller:StreamlistcontrollerCtrl\n * @description\n * # StreamlistcontrollerCtrl\n * Controller of the troutDashApp\n */\nangular.module('troutSpotr')\n\t.controller('StreamlistcontrollerCtrl', ['$scope', 'StreamApiService', \n\t\t'TableOfContentsRepository', 'RegionGeometryService', \n\t\t'$anchorScroll',\n\t\tfunction ($scope, StreamApiService, TableOfContentsRepository, RegionGeometryService, $anchorScroll) {\n\t\t$scope.isSmallView = false;\n\n\t\tvar getInitialMapState = function() {\n\t\t\tvar mapState = {\n\t\t\t\tisExpanded: false,\n\t\t\t\tisLoading: false,\n\t\t\t\tselectedRegionGeometry: null,\n\t\t\t\tselectedRegion: null,\n\t\t\t\tselectedCounty: null,\n\t\t\t\thighlightedStream: null,\n\t\t\t\tcurrentClientCoordinates: [NaN, NaN]\n\t\t\t};\n\t\t\treturn mapState;\n\t\t};\n\n\t\t$scope.mapState = getInitialMapState();\n\n\t\t$scope.selectCounty = function(countyId) {\n\t\t\tconsole.log(countyId);\n\t\t};\n\n\t\t$scope.selectRegion = function(regionModel) {\n\t\t\tif (regionModel == null) {\n\t\t\t\tthrow new Error('regionModel cannot be null');\n\t\t\t}\n\n\t\t\t\n\n\t\t\t// TODO: fix this to have an actual cache.\n\t\t\t// try to pull it from the cache\n\t\t\tvar canRetrieveFromCache = false;\n\t\t\tif (canRetrieveFromCache) {\n\t\t\t\t// return it from our cache.\n\t\t\t\t// TODO: fix this part too\n\t\t\t\t$scope.mapState.selectedRegionGeometry = null;\n\t\t\t\t$scope.mapState.selectedRegion = [regionModel];\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// load it from our repository.\n\t\t\tvar stateModel = regionModel.parent;\n\t\t\treturn RegionGeometryService.getRegion(stateModel, regionModel)\n\t\t\t\t.then(function(newSelectedRegionGeometry) {\n\t\t\t\t\t$scope.mapState.selectedRegionGeometry = [newSelectedRegionGeometry];\n\t\t\t\t\t$scope.mapState.selectedRegion = [regionModel];\n\t\t\t\t\t$anchorScroll('region-hdr_' + regionModel.id);\n\t\t\t\t\treturn newSelectedRegionGeometry;\n\t\t\t\t});\n\t\t};\n\n\t\t$scope.getTableOfContents = function() {\n\t\t\treturn TableOfContentsRepository.getTableOfContents()\n\t\t\t\t.then(function(toc) {\n\t\t\t\t\treturn toc;\n\t\t\t\t});\n\t\t};\n\n\t\t$scope.bustCache = function() {\n\t\t\tconsole.log('busting cache...');\n\t\t\t// this is actually going directly to the base cache...\n\t\t\tTableOfContentsRepository.bustTableOfContentsCache();\n\t\t};\n\n\t\t$scope.toggleMinimap = function() {\n\t\t\tif ($scope.mapState == null) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t$scope.mapState.isExpanded = !$scope.mapState.isExpanded;\n\t\t};\n\t}]);\n\n'use strict';\n\n/**\n * @ngdoc directive\n * @name troutDashApp.directive:streamLine\n * @description\n * # streamLine\n */\nangular.module('troutSpotr')\n  .directive('streamLine', function(LinearReferenceViewModel) {\n    return {\n      templateUrl: 'app/ui/streamLine/streamlinetemplate.html',\n      restrict: 'A',\n      link: function(scope, element, attrs) {\n        var length = parseFloat(scope.stream.LengthMiles);\n        if (length <= 0) {\n          return;\n        }\n        var inverseLength = 1 / length;\n        scope.stage = {\n          width: element.width() - 10\n        };\n\n        var ANIMATION_SPEED = 500;\n\n        var createTickMarks = function(LengthMiles) {\n          var clampedLength = Math.floor(length);\n          var tickMarks = [];\n          if (clampedLength < 1) {\n            tickMarks.push({\n              xOffset: 0,\n              width: 1,\n              height: 3,\n              yOffset: 7\n            });\n\n            return tickMarks;\n          }\n\n          var tickWidth = scope.stage.width / LengthMiles;\n          for (var i = 0; i <= clampedLength; i++) {\n            tickMarks.push({\n              xOffset: i * tickWidth,\n              width: 1.5,\n              height: 4,\n              yOffset: 8\n            });\n          }\n\n          return tickMarks;\n        };\n\n\n        scope.drawLines = function() {\n\n          var length = parseFloat(scope.stream.LengthMiles);\n          var inverseLength = 1 / length;\n          scope.streamLine = d3.select(element[0])\n            .append('svg')\n            .attr('class', 'stream-line')\n            .attr('width', scope.stage.width)\n            .attr('height', 16)\n            .attr('xmlns', 'http://www.w3.org/2000/svg');\n\n          // PUBLIC LAND\n          // Prepare\n          scope.publicSegments = scope.stream.Pal.Sections.map(function(segment) {\n            return new LinearReferenceViewModel(segment, inverseLength);\n          });\n\n          // Stage\n          scope.streamLine.publicLand = scope.streamLine.append('g')\n            .attr('class', 'stream-line_public-land');\n\n          // Execute\n          scope.streamLine.publicLand.selectAll('rect')\n            .data(scope.publicSegments).enter()\n            .append('rect')\n            .attr('x', function(d) {\n              return d.xOffset * scope.stage.width;\n            })\n            .attr('y', 0)\n            .attr('width', function(d) {\n              return d.width * scope.stage.width;\n            })\n            .attr('height', 11)\n            .attr('rx', 4)\n            .attr('ry', 4)\n            .attr('class', 'public-land')\n            .attr('style', 'opacity: 0;')\n            .transition()\n            .delay(3 * ANIMATION_SPEED)\n            .attr('style', 'opacity: 1');\n\n          // LAKES\n          // Prepare\n          scope.lakes = scope.stream.Lakes.Sections.map(function(segment) {\n            return new LinearReferenceViewModel(segment, inverseLength);\n          });\n\n          \n\n          // Stage\n          scope.streamLine.lakes = scope.streamLine.append('g')\n            .attr('class', 'stream-line_stream'); // TODO: CHANGE TO LAKE CLASS\n\n          // Execute\n          scope.streamLine.lakes.selectAll('rect')\n            .data(scope.lakes).enter()\n            .append('rect')\n            .attr('x', function(d) {\n              return d.xOffset * scope.stage.width;\n            })\n            .attr('y', 1)\n            .attr('width', function(d) {\n              return d.width * scope.stage.width;\n            })\n            .attr('height', 9)\n            .attr('rx', 4)\n            .attr('ry', 4)\n            .attr('class', 'stream-line_stream')\n            .attr('style', 'opacity: 0;')\n            .transition()\n            .delay(5 * ANIMATION_SPEED)\n            .attr('style', 'opacity: 1');\n\n          var tickMarks = createTickMarks(length);\n          var firstMark = tickMarks[0];\n\n          firstMark.width = 1;\n          firstMark.height = 5;\n          scope.streamLine.tickMarks = scope.streamLine\n            .append('g')\n            .attr('class', 'stream-line_grid-lines')\n            .selectAll('rect').data(tickMarks).enter()\n            .append('rect')\n            .attr('x', function(d) {\n              return scope.stage.width - d.xOffset - d.width;\n            })\n            .attr('y', function(d) {\n              return d.yOffset - 2;\n            })\n            .attr('width', function(d) {\n              return d.width;\n            })\n            .attr('height', function(d) {\n              return d.height;\n            })\n            .attr('class', 'tick')\n            .attr('style', 'opacity: 0;')\n            .transition()\n            .delay(function(d, i) {\n              return (500 / tickMarks.length) * i + (0.5 * ANIMATION_SPEED);\n            })\n            .attr('style', 'opacity: 1');;\n\n\n          // STREAM LINE\n          scope.streamLine.stream = scope.streamLine.append('g')\n            .attr('class', 'stream-line_stream')\n            .append('rect')\n            .attr('x', 0)\n            .attr('y', 5)\n            .attr('height', 1)\n            .attr('width', scope.stage.width)\n            .attr('style', 'opacity: 0;')\n            .transition()\n            .delay(0.1 * ANIMATION_SPEED)\n            .attr('style', 'opacity: 1');\n\n\n            scope.accessPoints = scope.stream.AccessPoints;\n\n          \n\n\n\n          // TROUT STREAM SECTIONS\n          scope.publicSegments = scope.stream.TroutStreams.Sections.map(function(segment) {\n            return new LinearReferenceViewModel(segment, inverseLength);\n          });\n\n          // Stage\n          scope.streamLine.troutStreamSections = scope.streamLine.append('g')\n            .attr('class', 'stream-line_route');\n\n          // Execute\n          scope.streamLine.append('g')\n            .attr('class', 'stream-line_route')\n            .selectAll('g').data(scope.publicSegments).enter()\n            .append('g')\n            .append('rect')\n            .attr('x', function(d) {\n              return d.xOffset * scope.stage.width;\n            })\n            .attr('y', 3)\n            .attr('width', function(d) {\n              return d.width * scope.stage.width;\n            })\n            .attr('height', 5)\n            .attr('class', 'stream-line_route')\n            .attr('style', 'opacity: 0;')\n            .transition()\n            .delay(2 * ANIMATION_SPEED)\n            .attr('style', 'opacity: 1');\n\n          // RESTRICTIONS\n          scope.stream.Restrictions.forEach(function(restriction, index) {\n\n            var restrictionModels = restriction.Sections.map(function(segment) {\n              var linearReferenceViewModel = new LinearReferenceViewModel(segment, inverseLength);\n              segment.segment = linearReferenceViewModel;\n              return segment;\n            });\n\n            scope.streamLine.append('g')\n              .attr('class', index === 0 ? 'stream-line_restriction' : 'stream-line_restriction_secondary')\n              .selectAll('g').data(restrictionModels).enter()\n              .append('g')\n              // .selectAll('rect').data(function(d) {\n              //     return d.segment;\n              // }).enter()\n              .append('rect')\n              .attr('x', function(d) {\n                return d.segment.xOffset * scope.stage.width;\n              })\n              .attr('y', 3)\n              .attr('width', function(d) {\n                return d.segment.width * scope.stage.width;\n              })\n              .attr('height', 5)\n              .attr('class', 'restriction')\n              .attr('style', 'opacity: 0;')\n              .transition()\n              .delay(5 * ANIMATION_SPEED)\n              .attr('style', 'opacity: 1');\n          });\n\n          scope.streamLine.roadIntersections = scope.streamLine.append('g')\n            .attr('class', 'stream-line_roadIntersections');\n\n\n          scope.streamLine.roadIntersections.selectAll('circle')\n            .data(scope.accessPoints).enter()\n            .append('circle')\n            .attr('cy', 5.5)\n            .attr('r', 3)\n            .attr('cx', function(d) {\n              return (1 - (d.LinearOffset / length)) * scope.stage.width;\n            })\n            .attr('class', function(d) {\n              var isUninteresting = d.IsOverOrNearPublicLand === false && d.IsOverOrNearTroutStreamSection === false;\n              if (isUninteresting) {\n                return 'roadIntersetion_inactive';\n              }\n\n              if (d.IsOverOrNearPublicLand === false) {\n                return 'roadIntersetion_private';\n              }\n              return 'roadIntersetion_public';\n            })\n            .attr('style', 'opacity: 0;')\n            .transition()\n            .delay(function(d, i) {\n              return (500 / scope.accessPoints.length) * i + (4 * ANIMATION_SPEED);\n            })\n            .attr('style', 'opacity: 1');\n\n          \n        };\n\n\n\n        scope.drawLines();\n      }\n    };\n  });\n'use strict';\n(function(angular) {\n    var fsm = angular.module('fsm');\n\n    fsm.directive('fsmStickyHeader', ['$rootScope', function($rootScope) {\n        return {\n            restrict: 'EA',\n            replace: false,\n            scope: {\n                scrollBody: '=',\n                scrollStop: '=',\n                scrollableContainer: '=',\n                contentOffset: '=',\n                scrollObject: '=',\n                zIndexOverride: '='\n            },\n            link: function(scope, element, attributes, control) {\n                var header = $(element, this);\n                var getContent = function() {\n\n                    var candidateContent;\n                    if (content == null || content.length !== 1) {\n                        content = $(scope.scrollBody);\n                    }\n\n                    return content;\n                };\n\n                scope.zIndexOverride = scope.zIndexOverride != null ? scope.zIndexOverride : 10000;\n\n                var content = getContent();\n                var clonedHeader = null;\n                var content = $(scope.scrollBody);\n                var scrollableContainer = $(scope.scrollableContainer);\n                var contentOffset = scope.contentOffset || 0;\n\n                if (scrollableContainer.length === 0) {\n                    scrollableContainer = $(window);\n                }\n\n                function setColumnHeaderSizes() {\n                    if (clonedHeader.is('tr') || clonedHeader.is('thead')) {\n                        var clonedColumns = clonedHeader.find('th');\n                        header.find('th').each(function(index, column) {\n                            var clonedColumn = $(clonedColumns[index]);\n                            clonedColumn.css('width', column.offsetWidth + 'px');\n                        });\n                    }\n                };\n\n                function determineVisibility() {\n                    var scrollTop = scrollableContainer.scrollTop() + scope.scrollStop;\n                    var currentContent = getContent();\n                    if (currentContent.length !== 1) {\n                        return;\n                    }\n                    var contentTop = currentContent.offset().top;\n                    var contentBottom = contentTop + currentContent.outerHeight(false);\n\n                    if ((scrollTop > contentTop) && (scrollTop < contentBottom)) {\n                        if (!clonedHeader) {\n                            createClone();\n                            clonedHeader.css({\n                                \"visibility\": \"visible\"\n                            });\n                        }\n\n                        if (scrollTop < contentBottom && scrollTop > contentBottom - clonedHeader.outerHeight(false)) {\n                            var top = contentBottom - scrollTop + scope.scrollStop - clonedHeader.outerHeight(false);\n                            clonedHeader.css('top', top + 'px');\n                        } else {\n                            calculateSize();\n                        }\n                    } else {\n                        if (clonedHeader) {\n                            /*\n                             * remove cloned element (switched places with original on creation)\n                             */\n                            header.remove();\n                            header = clonedHeader;\n                            clonedHeader = null;\n\n                            header.removeClass('fsm-sticky-header');\n                            header.css({\n                                position: 'relative',\n                                left: 0,\n                                top: 0,\n                                width: 'auto',\n                                'z-index': 0,\n                                visibility: 'visible'\n                            });\n                        }\n                    }\n                };\n\n                function calculateSize() {\n                    clonedHeader.css({\n                        top: scope.scrollStop,\n                        width: header.outerWidth(),\n                        left: header.offset().left\n                    });\n\n                    setColumnHeaderSizes();\n                };\n\n                function createClone() {\n                    /*\n                     * switch place with cloned element, to keep binding intact\n                     */\n                    $rootScope.$broadcast('header-clone', scope.scrollObject);\n                    clonedHeader = header;\n                    header = clonedHeader.clone();\n                    clonedHeader.after(header);\n                    clonedHeader.addClass('fsm-sticky-header');\n                    clonedHeader.css({\n                        position: 'fixed',\n                        'z-index': scope.zIndexOverride,\n                        visibility: 'hidden'\n                    });\n                    calculateSize();\n                };\n\n                scrollableContainer.on('scroll.fsmStickyHeader', determineVisibility).trigger(\"scroll\");\n                scrollableContainer.on('resize.fsmStickyHeader', determineVisibility);\n\n                scope.$on('$destroy', function() {\n                    scrollableContainer.off('.fsmStickyHeader');\n                });\n            }\n        };\n    }]);\n\n    fsm.directive('fsmMenu', ['$location', function($location) {\n        return {\n            restrict: 'A',\n            scope: {},\n            link: function(scope, el, attrs) {\n                var navigationMenu = angular.element(el);\n                var menuTitles = navigationMenu.find('.fsm-menu-title');\n                var menuItems = navigationMenu.find('[tc-menu-item]:visible');\n                var activeMenu = 0;\n\n                function menuOnClick(e) {\n                    var menuTitle = angular.element(e.currentTarget);\n                    // Find if our menu item has submenu items\n                    var submenu = menuTitle.next('.fsm-sub-menu');\n\n                    // If there is submenus, then we wan to either open or close the folder\n                    submenu.slideToggle('fast', function() {\n                        // swap the arrow from up to down, or vise-versa\n                        var chevron = menuTitle.children('[class*=\\'fa-chevron\\']');\n                        chevron.toggleClass('fa-chevron-down fa-chevron-up');\n\n                        // Find the list of currently visible menu items for keyboarding through.\n                        menuItems = navigationMenu.find('[tc-menu-item]:visible');\n                    });\n\n                }\n\n                function menuOnKeydown(e) {\n                    activeMenu = getCurrentMenuItem();\n\n                    if (e.keyCode === 9) {\n                        tabOutOfMenu(e);\n                    } else if (e.keyCode === 13 || e.keyCode === 37 || e.keyCode === 39) {\n                        triggerMenuItem(e);\n                    } else if (e.keyCode === 38 || e.keyCode === 40) {\n                        highlightMenuItem(e);\n                    }\n                }\n\n                function tabOutOfMenu(e) {\n                    if (e.shiftKey) {\n                        $('[fsm-menu-button]').focus();\n                    } else {\n                        var firstTabItem = $('[tabindex=1]');\n\n                        if (firstTabItem.length == 0) {\n                            return;\n                        } else {\n                            firstTabItem.focus();\n                        }\n                    }\n\n                    e.preventDefault();\n                    e.stopPropagation();\n                }\n\n                function triggerMenuItem(e) {\n                    e.currentTarget = $(menuItems[activeMenu]).children('a').first();\n                    menuOnClick(e);\n                }\n\n                function highlightMenuItem(e) {\n                    e.preventDefault();\n                    e.stopPropagation();\n\n                    if (e.keyCode === 38) {\n                        if (activeMenu > 0) {\n                            $(menuItems[activeMenu - 1]).children('a').first().focus();\n                        } else {\n                            $(menuItems[menuItems.length - 1]).children('a').first().focus();\n                        }\n                    } else if (e.keyCode === 40) {\n                        if (activeMenu < (menuItems.length - 1)) {\n                            $(menuItems[activeMenu + 1]).children('a').first().focus();\n                        } else {\n                            $(menuItems[0]).children('a').first().focus();\n                        }\n                    }\n                }\n\n                function getCurrentMenuItem() {\n                    var focusedMenu = navigationMenu.find(':focus');\n\n                    if (focusedMenu.length === 1) {\n                        return menuItems.index(focusedMenu.parent('[tc-menu-item]').first());\n                    }\n\n                    return menuItems.index(navigationMenu.find('[tc-menu-item].active').first());\n                }\n\n                function menuOnFocus(e) {\n                    e.preventDefault();\n                    e.stopPropagation();\n\n                    activeMenu = getCurrentMenuItem();\n                    $(menuItems[activeMenu]).children('a').first().focus();\n                }\n\n                menuTitles.click(menuOnClick);\n                navigationMenu.keydown(menuOnKeydown);\n                navigationMenu.focus(menuOnFocus);\n\n                scope.$watch(function() {\n                    return $location.path();\n                }, function(path) {\n                    // grab all the a tags that start with #, indicating and angular route.\n                    var allMenuItems = el.find('a[href^=\\'#\\']');\n\n                    angular.forEach(allMenuItems, function(menuItem) {\n                        var menu = angular.element(menuItem);\n                        var link = menu.attr('href').split('#')[1];\n\n                        if (path.indexOf(link) == 0) {\n                            // activate the menu item\n                            angular.element(menuItem.parentElement).addClass('active');\n\n                            // open up the submenus if they are not open\n                            var submenus = menu.parents('.fsm-sub-menu');\n                            submenus.show();\n\n                            // turn the chevrons up on the menu titles\n                            var chevrons = submenus.prev().children('[class*=\\'fa-chevron\\']');\n                            chevrons.removeClass('fa-chevron-down');\n                            chevrons.addClass('fa-chevron-up');\n                        } else {\n                            angular.element(menuItem.parentElement).removeClass('active');\n                        }\n                    });\n\n                    menuItems = navigationMenu.find('[tc-menu-item]:visible');\n                });\n            }\n        }\n    }]);\n\n    fsm.directive('fsmMenuButton', function() {\n        return {\n            restrict: 'EA',\n            replace: false,\n            scope: {},\n            link: function(scope, element, attributes, control) {\n                var menuButton = $(element, this);\n\n                menuButton.addClass('fsm-menu-button');\n                menuButton.keydown(menuOnKeydown);\n                $('body').keydown(bodyOnKeydown);\n\n                function bodyOnKeydown(e) {\n                    if (e.keyCode === 77 && e.ctrlKey && e.altKey) {\n                        if (isMenuClosed()) {\n                            menuOnClick();\n                        }\n                        $('[fsm-menu]').focus();\n                    } else if (e.keyCode === 77 && e.ctrlKey) {\n                        menuButton.focus();\n                        menuOnClick();\n                    }\n                }\n\n                function isMenuClosed() {\n                    return $('body').hasClass('fsm-menu-toggle');\n                }\n\n                function menuOnClick() {\n                    $('body').toggleClass('fsm-menu-toggle');\n                    setMenuSpin();\n                    setTimeout(setMenuSpin, 50);\n                };\n\n                function menuOnKeydown(e) {\n                    if (e.keyCode === 32 || e.keyCode === 13) {\n                        e.preventDefault();\n                        e.stopPropagation();\n                        menuOnClick();\n                    }\n                }\n\n                function setMenuSpin() {\n                    menuButton.find('.fsm-menu-button-open').toggleClass('fsm-spin-forward');\n                    menuButton.find('.fsm-menu-button-close').toggleClass('fsm-spin-backward');\n                };\n\n                menuButton.on('click.fsmMenuButton', menuOnClick);\n\n                scope.$on('$destroy', function() {\n                    menuButton.off('.fsmMenuButton');\n                });\n            }\n        }\n    });\n\n    fsm.directive('fsmBigData', ['$filter', function($filter) {\n\n        return {\n            restrict: 'AE',\n            scope: {},\n            replace: false,\n            transclude: true,\n            link: function(scope, element, attrs, controller, transclude) {\n                var orderBy = $filter('orderBy');\n                var currentPage = 0;\n                var pagedDataName = attrs.fsmBigData.split(' of ')[0];\n                var rightHandExpression = attrs.fsmBigData.split(' of ')[1];\n                var pageSize = parseInt(rightHandExpression.split(' take ')[1], 10);\n                var sourceData = rightHandExpression.split(' take ')[0];\n\n                // Interesting things can be done here with the source object...\n                // var displayGetter = $parse(sourceData);\n                // var displaySetter = displayGetter.assign;\n                // var results = orderBy(displayGetter(scope.$parent), sortColumns);\n                // displaySetter(scope.$parent, results)\n\n                var rawData = [];\n                var sortedData = [];\n                var pagedData = [];\n                var page = $(window);\n                var sortTypes = ['None', 'Ascending', 'Descending'];\n                var sortColumns = [];\n\n                transclude(function(clone, transcludedScope) {\n\n                    transcludedScope.sortTypes = sortTypes;\n\n                    element.append(clone);\n                    transcludedScope[pagedDataName] = pagedData;\n\n                    function nextPage() {\n                        var dataSlice = sortedData.slice(pageSize * currentPage, (pageSize * (currentPage + 1)));\n                        if (dataSlice.length > 0) {\n                            pagedData.push.apply(pagedData, dataSlice);\n                            currentPage++;\n                        }\n                    }\n\n                    function renderData() {\n                        if (sortColumns.length) {\n                            sortedData = orderBy(rawData, sortColumns);\n                        } else {\n                            sortedData = rawData;\n                        }\n\n                        pagedData.length = 0;\n                        currentPage = 0;\n                        nextPage();\n                    }\n\n                    function addSortColumn(columnName, sortType) {\n\n                        // If this column is currently in the sort stack, remove it.\n                        for (var i = 0; i < sortColumns.length; i++) {\n                            if (sortColumns[i].indexOf(columnName) > -1) {\n                                sortColumns.splice(i, 1);\n                            }\n                        }\n\n                        // Push this sort on the top of the stack (aka. array)\n                        if (sortType > 0) {\n                            var direction = '';\n                            if (sortTypes[sortType] === 'Descending') {\n                                direction = '-';\n                            }\n                            sortColumns.unshift(direction + columnName);\n                        }\n\n                        renderData();\n                    }\n\n                    function onPageScroll() {\n                        var s = $(window).scrollTop();\n                        var d = $(document).height();\n                        var c = $(window).height();\n                        var scrollPercent = (s / (d - c));\n\n                        if (scrollPercent > 0.98) {\n                            // We use scope.apply here to tell angular about these changes because \n                            // they happen outside of angularjs context... we're using jquery here\n                            // to figure out when we need to load another page of data.\n                            transcludedScope.$apply(nextPage);\n                        }\n                    }\n\n                    transcludedScope.$parent.$watchCollection(sourceData, function(newData) {\n                        if (newData) {\n                            rawData = newData;\n                            renderData();\n                        }\n                    });\n\n                    transcludedScope.addSortColumn = addSortColumn;\n\n                    page.on('scroll.fsmBigData', onPageScroll).trigger('scroll');\n\n                    transcludedScope.$on('$destroy', function() {\n                        page.off('.fsmBigData');\n                    });\n                });\n            }\n        };\n    }]);\n\n    fsm.directive('fsmSort', [function() {\n        var sortIconTemplate = '<i class=\"fa fa-sort\"></i>';\n\n        return {\n            restrict: 'AE',\n            replace: false,\n            scope: {},\n            link: function(scope, element, attrs) {\n                var columnHeader = element;\n                var columnName = attrs.fsmSort;\n                var sortIcon = angular.element(sortIconTemplate);\n                columnHeader.append('&nbsp;');\n                columnHeader.append(sortIcon);\n                var currentSortType = 0;\n\n                function swapIcons() {\n                    sortIcon.removeClass('fa-sort-desc fa-sort-asc fa-sort');\n\n                    var classToAdd = 'fa-sort';\n\n                    if (scope.$parent.sortTypes[currentSortType] === 'Ascending') {\n                        classToAdd = 'fa-sort-asc';\n                    } else if (scope.$parent.sortTypes[currentSortType] === 'Descending') {\n                        classToAdd = 'fa-sort-desc';\n                    }\n\n                    sortIcon.addClass(classToAdd);\n                };\n\n                function applySort() {\n                    // Find the kind of sort this should now be\n                    currentSortType++;\n                    if (currentSortType == scope.$parent.sortTypes.length) {\n                        currentSortType = 0;\n                    }\n\n                    scope.$apply(scope.$parent.addSortColumn(columnName, currentSortType));\n\n                    swapIcons();\n                };\n\n                columnHeader.css({\n                    cursor: 'pointer'\n                });\n\n                columnHeader.on('click.fsmSort', applySort);\n\n                columnHeader.on('keydown.fsmSort', function(e) {\n                    if (e.keyCode === 13) {\n                        applySort();\n                        e.preventDefault();\n                        e.stopPropagation();\n                    }\n                });\n\n                scope.$on('$destroy', function() {\n                    columnHeader.off('.fsmSort');\n                });\n            }\n        };\n    }]);\n})(window.angular);\n'use strict';\n\n/**\n * @ngdoc directive\n * @name troutDashApp.directive:speciesSummary\n * @description\n * # speciesSummary\n */\nangular.module('troutSpotr')\n  .directive('speciesSummary', function() {\n    return {\n      templateUrl: 'app/ui/speciesSummary/speciessummarytemplate.html',\n      restrict: 'A',\n      link: function postLink(scope, element, attrs) {}\n    };\n  });\n'use strict';\n\n/**\n * @ngdoc directive\n * @name troutDashApp.directive:restrictionLegend\n * @description\n * # restrictionLegend\n */\nangular.module('troutSpotr')\n  .directive('restrictionLegend', function () {\n    return {\n      templateUrl: 'app/ui/restrictions/restrictionlegendtemplate.html',\n      restrict: 'A',\n      link: function postLink(scope, element, attrs) {\n      \tconsole.log('restrictionlegend directive', scope.stream);\n      }\n    };\n  });\n\n'use strict';\n\n/**\n * @ngdoc directive\n * @name troutDashApp.directive:miniMapDirective\n * @description\n * # miniMapDirective\n */\n\nvar MINI_MAP_CLASS = '.js-mini-map';\n\nangular.module('troutSpotr')\n  .directive('miniMapDirective', [\n    '$rootScope', 'GeometryApiService', '$q', '$timeout',\n    function($rootScope, GeometryApiService, $q, $timeout) {\n      return {\n        // app/ui/main/main.html\n        templateUrl: 'app/ui/miniMap/minimaptemplate.html',\n        restrict: 'A',\n        link: function postLink(scope, element, attrs) {\n          scope.minimapState = {\n            isLoading: true,\n            regionGeometries: null,\n            selectedRegionId: null,\n            selectedCountyId: null,\n            width: 75,\n            height: 45,\n            isMacro: true,\n\n            loadingRegion: d3.select(null)\n          };\n\n          scope.active = d3.select(null);\n          scope.selectedCounty = d3.select(null);\n\n          $rootScope.$on('county-select', function(event, item) {\n            console.log(item);\n\n          });\n\n          $rootScope.$on('header-clone', function(event, item) {\n            if (item == null) {\n              return;\n            }\n\n            if (item.type === 'region') {\n              $timeout(function() {\n                scope.minimapState.selectedRegionId = item.id;\n                scope.$apply();\n              });\n              return;\n            }\n\n            if (item.type === 'county') {\n              $timeout(function() {\n                scope.minimapState.selectedCountyId = item.name;\n                scope.$apply();\n              });\n              return;\n            }\n          });\n\n          var unwatchRegionId = scope.$watch(function() {\n            return scope.minimapState.selectedRegionId;\n          }, function(newRegionId, oldRegionId) {\n            if (newRegionId == null) {\n              return;\n            }\n\n            if (newRegionId === oldRegionId) {\n              return;\n            }\n            // console.log('new region!', newRegionId);\n\n            var soughtRegion = scope.currentRegions.filter(function(f) {\n              return f.id === newRegionId;\n            });\n\n            if (soughtRegion.length > 0 && newRegionId !== oldRegionId) {\n              zoomToGeometry(soughtRegion[0]);\n            }\n\n          });\n\n          var unwatchCountyId = scope.$watch(function() {\n            return scope.minimapState.selectedCountyId;\n          }, function(newCounty, oldCounty) {\n            if (newCounty == null) {\n              return;\n            }\n\n            // console.log('new County!', newCounty);\n            var soughtCounty = scope.currentCounties.filter(function(f) {\n              return f.name === newCounty;\n            });\n            if (soughtCounty.length > 0 && newCounty !== oldCounty) {\n              selectCounty(soughtCounty[0]);\n            }\n          });\n\n          var unwatchGeometries = scope.$watch(function() {\n            return scope.minimapState.regionGeometries;\n          }, function(newGeometries, oldGeometries) {\n            if (newGeometries == null) {\n              return;\n            }\n\n            drawGeometries(newGeometries);\n          });\n\n          var drawGeometries = function(geometries) {\n            var root = d3.select(element[0]);\n          };\n\n          var highlightCounty = function(countyId) {\n            console.log('highlight county');\n          };\n\n          var zoomToRegion = function(regionId) {\n            console.log('zoom to region');\n          };\n\n          // var gettingGeometries = GeometryApiService.getRegionGeometries();\n          // var gettingRegionData = StreamApiService.getRegions();\n\n          // This function takes geometry and will create a geometry and path\n          // function that are centred on this geometry.\n          var initializeMap = function(stateObject) {\n            // initialize a unit projection.\n            scope.projection = d3.geo.albersUsa()\n              .scale(1)\n              .translate([0, 0]);\n\n            // Create a path generator.\n            scope.path = d3.geo.path()\n              .projection(scope.projection)\n              .pointRadius(0.15);\n\n            var state = stateObject.geometry;\n\n            // Compute the bounds of a feature of interest, then derive scale & translate.\n            var b = scope.path.bounds(state),\n              s = 0.95 / Math.max((b[1][0] - b[0][0]) / scope.minimapState.width, (b[1][1] - b[0][1]) / scope.minimapState.height),\n              t = [(scope.minimapState.width - s * (b[1][0] + b[0][0])) / 2, (scope.minimapState.height - s * (b[1][1] + b[0][1])) / 2];\n\n            // Update the projection to use computed scale & translate.\n            scope.projection\n              .scale(s)\n              .translate(t);\n\n            scope.zoom = d3.behavior.zoom()\n              .translate([0, 0])\n              .scale(1)\n              .scaleExtent([1, 8])\n              .size([scope.minimapState.width, scope.minimapState.height])\n              .on('zoom', zoomed);\n\n            scope.svg = d3.select(element[0]).select(MINI_MAP_CLASS)\n              .append('svg')\n              .attr('viewBox', '0 0 ' + scope.minimapState.width + ' ' + scope.minimapState.height)\n              .attr('preserveAspectRatio', 'xMinYMin meet')\n              .attr('class', 'minimap-root')\n              .on('click', stopped, true);\n\n            scope.root = scope.svg.append('g')\n              .attr('class', 'minimap-geography');\n\n            scope.root.append('rect')\n              .attr('class', 'minimap-geography_background')\n              .attr('width', '100%')\n              .attr('height', '100%')\n              .on('click', onBackgroundClick);\n\n            scope.counties = scope.root.append('g')\n              .attr('class', 'minimap-geography minimap-geogrpahy_counties');\n\n            scope.states = scope.root.append('g')\n              .attr('class', 'minimap-geography minimap-geogrpahy_states');\n\n            scope.streams = scope.root.append('g')\n              .attr('class', 'minimap-geography minimap-geogrpahy_streams');\n\n            scope.regions = scope.root.append('g')\n              .attr('class', 'minimap-geography minimap-geogrpahy_regions');\n          };\n\n          var onRegionClick = function(region, regionId) {\n            var isMacro = scope.minimapState.isMacro;\n            if (isMacro) {\n              // assume selection has occured.\n              // set loading state on region.\n              onLoadRegion.bind(this)(region);\n              scope.minimapState.selectedRegionId = region.id;\n              scope.selectRegion(region)\n                .then(function(geometry) {\n                  $timeout(function() {\n\n                    resetLoadRegion();\n                    // set controller's state\n                    $timeout(minifyMinimap, 500);\n                  }, 1000);\n\n                });\n\n              // TODO: remove the minification.\n            } else {\n              macrofyMinimap();\n            }\n\n            $timeout(function() {\n              scope.$apply();\n            });\n          };\n\n          var onBackgroundClick = function() {\n            var isMacroMode = scope.minimapState.isMacro;\n            if (isMacroMode) {\n              // TODO: reset state\n              // TODO: set to minify\n              if (scope.mapState.selectedRegion == null || scope.mapState.selectedRegion.length === 0) {\n                return;\n              }\n\n              // onRegionClick(scope.mapState.selectedRegion);\n              zoomToGeometry(scope.mapState.selectedRegion[0]);\n              minifyMinimap();\n\n            } else {\n              // TODO: set state to outer.\n              macrofyMinimap();\n            }\n\n            $timeout(function() {\n              scope.$apply();\n            });\n\n          };\n\n          var minifyMinimap = function() {\n            scope.minimapState.isMacro = false;\n          };\n\n          var macrofyMinimap = function() {\n            scope.minimapState.isMacro = true;\n            reset();\n          };\n\n\n          var drawGeometryToMap = function(states, regions, counties) {\n            // scope.countiesGroup = scope.counties;\n            scope.counties.selectAll('path.minimap-geography_county')\n              .data(counties, function(d) {\n                return d.id;\n              })\n              .enter().append('path')\n              .attr('d', function(d) {\n                return scope.path(d.geometry);\n              })\n              .attr('data-id', function(d) {\n                return getFipsCodeSelector(d);\n              })\n              .attr('class', 'minimap-geography_county');\n\n            scope.regions.selectAll('path.minimap-geogrpahy_region')\n              .data(regions, function(d) {\n                return d.id;\n              })\n              .enter().append('path')\n\n            .attr('class', 'minimap-geogrpahy_region')\n              .attr('data-id', function(d) {\n                return d.id;\n              })\n              .attr('id', function(d) {\n                return 'region_' + d.id;\n              })\n              .attr('data-name', function(d) {\n                return d.shortName;\n              })\n              .attr('d', function(d) {\n                return scope.path(d.geometry);\n              })\n              .on('click', onRegionClick);\n          };\n\n          function reset() {\n            scope.active.classed('active', false);\n            scope.active = d3.select(null);\n\n            scope.svg.transition()\n              .duration(300)\n              .call(scope.zoom.translate([0, 0]).scale(1).event);\n          }\n\n          function zoomed() {\n            scope.root.style('stroke-width', 1.5 / d3.event.scale + 'px');\n            scope.root.attr('transform', 'translate(' + d3.event.translate + ')scale(' + d3.event.scale + ')');\n          }\n\n          function onLoadRegion(regionElement) {\n            resetLoadRegion();\n            scope.minimapState.loadingRegion = d3.select(this).classed('minimap-geogrpahy_region_loading', true);\n            // show streams.\n            var arrayOfStreams = regionElement.children.map(function(county) {\n              return county.children;\n            });\n\n            var selectedStreams = _.unique(_.flatten(arrayOfStreams), 'Id');\n\n\n            var streamObjects = scope.streams.selectAll('path.minimap-geography_stream')\n              .data(selectedStreams, function(d) {\n                return d.Id;\n              });\n            streamObjects.enter()\n              .append('path')\n              .attr('class', 'minimap-geography_stream')\n              .attr('data-id', function(d) {\n                return d.id;\n              })\n              .attr('id', function(d) {\n                return 'streamPoint_' + d.id;\n              })\n              .attr('data-name', function(d) {\n                return d.name;\n              })\n              .attr('d', function(d) {\n                return scope.path(d.geometry);\n              })\n              .style('opacity', 0)\n              .transition()\n              .delay(200)\n              .duration(750)\n              .style('opacity', 1);\n\n            streamObjects.exit()\n              .transition()\n              .duration(300)\n              .style('opacity', 0)\n              .remove();\n\n          }\n\n          function resetLoadRegion() {\n            if (scope.minimapState.loadingRegion == null) {\n              return;\n            }\n\n            scope.minimapState.loadingRegion.classed('minimap-geogrpahy_region_loading', false);\n            scope.minimapState.loadingRegion = d3.select(null);\n          }\n\n          function zoomToGeometry(d, t) {\n            if (scope.active.node() === this)  {\n              return reset();\n            }\n            scope.active.classed('active', false);\n            // scope.active = d3.select(element[0]).classed('active', true);\n            var bounds = scope.path.bounds(d.geometry),\n              dx = bounds[1][0] - bounds[0][0],\n              dy = bounds[1][1] - bounds[0][1],\n              x = (bounds[0][0] + bounds[1][0]) / 2,\n              y = (bounds[0][1] + bounds[1][1]) / 2,\n              scale = 0.95 / Math.max(dx / scope.minimapState.width, dy / scope.minimapState.height),\n              translate = [scope.minimapState.width / 2 - scale * x, scope.minimapState.height / 2 - scale * y];\n\n            scope.svg.transition()\n              .delay(200)\n              .duration(750)\n              .call(scope.zoom.translate(translate).scale(scale).event);\n          }\n\n          function getFipsCode(countyFeature) {\n            if (countyFeature == null) {\n              return '';\n            }\n\n            var fips = countyFeature.statefp + countyFeature.countyfp;\n            return fips;\n          }\n\n          function getFipsCodeSelector(countyFeature) {\n            return 'county_' + getFipsCode(countyFeature);\n          }\n\n          function selectCounty(d) {\n            var fips = getFipsCodeSelector(d);\n            var attribute = '[data-id=' + fips + ']';\n            var t = scope.counties.select(attribute).node();\n            if (scope.selectedCounty.node() === t) {\n              return;\n            }\n\n            scope.selectedCounty.classed('active', false);\n            scope.selectedCounty = d3.select(t).classed('active', true);\n          }\n\n          function stopped() {\n            if (d3.event.defaultPrevented) d3.event.stopPropagation();\n          }\n\n          scope.getTableOfContents()\n            .then(function(toc) {\n\n              var states = _.map(toc);\n              var regions = _(states)\n                .pluck('children')\n                .flatten()\n                .value();\n\n              var counties = _(regions)\n                .pluck('children')\n                .flatten()\n                .value();\n\n              scope.currentState = states[0];\n              scope.currentCounties = counties;\n              scope.currentRegions = regions;\n\n              var minStreamCount = 0;\n              var countyStreamCounts = scope.currentCounties.map(function(feat) {\n                return Math.max(0, feat.stream_count);\n              });\n              var maxStreamCount = d3.max(countyStreamCounts);\n\n              scope.countyChoroplethScale = d3.scale.linear()\n                .domain([minStreamCount, maxStreamCount])\n                .range(['#FFFFBB', '#BB00CC']);\n\n\n              scope.minimapState.isLoading = false;\n              initializeMap(scope.currentState);\n              drawGeometryToMap(states, regions, counties);\n\n            });\n\n          scope.$on('$destroy', function() {\n            unwatchRegionId();\n            unwatchCountyId();\n            unwatchGeometries();\n            unwatchTableOfContents();\n          });\n        }\n      };\n    }\n  ]);\n(function() {\n\t'use strict';\n\n\t/**\n\t * @ngdoc function\n\t * @name troutDashApp.controller:StreamlistcontrollerCtrl\n\t * @description\n\t * # StreamlistcontrollerCtrl\n\t * Controller of the troutDashApp\n\t */\n\tangular.module('troutSpotr')\n\t\t.controller('MainController', ['$scope', 'StreamApiService',\n\t\t\t'TableOfContentsRepository', 'RegionGeometryService',\n\t\t\t'$anchorScroll',\n\t\t\tfunction($scope, StreamApiService, TableOfContentsRepository, RegionGeometryService, $anchorScroll) {\n\t\t\t\t$scope.isSmallView = true;\n\t\t\t\tvar getInitialMapState = function() {\n\t\t\t\t\tvar mapState = {\n\t\t\t\t\t\tisExpanded: false,\n\t\t\t\t\t\tisLoading: false,\n\t\t\t\t\t\tselectedRegionGeometry: null,\n\t\t\t\t\t\tselectedRegion: null,\n\t\t\t\t\t\tselectedCounty: null,\n\t\t\t\t\t\thighlightedStream: null,\n\t\t\t\t\t\tcurrentClientCoordinates: [NaN, NaN]\n\t\t\t\t\t};\n\t\t\t\t\treturn mapState;\n\t\t\t\t};\n\n\t\t\t\t$scope.mapState = getInitialMapState();\n\n\t\t\t\t$scope.selectCounty = function(countyId) {\n\t\t\t\t\tconsole.log(countyId);\n\t\t\t\t};\n\n\t\t\t\t$scope.selectRegion = function(regionModel) {\n\t\t\t\t\tif (regionModel == null) {\n\t\t\t\t\t\tthrow new Error('regionModel cannot be null');\n\t\t\t\t\t}\n\n\n\n\t\t\t\t\t// TODO: fix this to have an actual cache.\n\t\t\t\t\t// try to pull it from the cache\n\t\t\t\t\tvar canRetrieveFromCache = false;\n\t\t\t\t\tif (canRetrieveFromCache) {\n\t\t\t\t\t\t// return it from our cache.\n\t\t\t\t\t\t// TODO: fix this part too\n\t\t\t\t\t\t$scope.mapState.selectedRegionGeometry = null;\n\t\t\t\t\t\t$scope.mapState.selectedRegion = [regionModel];\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t// load it from our repository.\n\t\t\t\t\tvar stateModel = regionModel.parent;\n\t\t\t\t\treturn RegionGeometryService.getRegion(stateModel, regionModel)\n\t\t\t\t\t\t.then(function(newSelectedRegionGeometry) {\n\t\t\t\t\t\t\t$scope.mapState.selectedRegionGeometry = [newSelectedRegionGeometry];\n\t\t\t\t\t\t\t$scope.mapState.selectedRegion = [regionModel];\n\t\t\t\t\t\t\t$anchorScroll('region-hdr_' + regionModel.id);\n\t\t\t\t\t\t\treturn newSelectedRegionGeometry;\n\t\t\t\t\t\t});\n\t\t\t\t};\n\n\t\t\t\t$scope.getTableOfContents = function() {\n\t\t\t\t\treturn TableOfContentsRepository.getTableOfContents()\n\t\t\t\t\t\t.then(function(toc) {\n\t\t\t\t\t\t\treturn toc;\n\t\t\t\t\t\t});\n\t\t\t\t};\n\n\t\t\t\t$scope.bustCache = function() {\n\t\t\t\t\tconsole.log('busting cache...');\n\t\t\t\t\t// this is actually going directly to the base cache...\n\t\t\t\t\tTableOfContentsRepository.bustTableOfContentsCache();\n\t\t\t\t};\n\n\t\t\t\t$scope.toggleMinimap = function() {\n\t\t\t\t\tif ($scope.mapState == null) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t$scope.mapState.isExpanded = !$scope.mapState.isExpanded;\n\t\t\t\t};\n\t\t\t}\n\t\t]);\n\n})();\nangular.module('troutSpotr')\n  .factory('RectangleLayoutService', [function() {\n    'use strict';\n\n    function RectangleLayoutService(width, height) {\n      this.width = width;\n      this.height = height;\n    }\n\n    var proto = RectangleLayoutService.prototype;\n\n    function getScale(width, height, itemLength) {\n      return Math.sqrt(itemLength / (width * height));\n    }\n\n    function getXGivenY(width, height, y) {\n      return (width / height) * y;\n    }\n\n    function getYGivenX(width, height, x) {\n      return (height / width) * x;\n    }\n\n    function pythagoreanTheorem(x, y) {\n      return Math.sqrt((x * x) + (y * y));\n    }\n\n    proto.getBoundingBox = function (numberOfItems) {\n      if (numberOfItems === 1) {\n        return [1, 1];\n      }\n\n      var scale = getScale(this.width, this.height, numberOfItems);\n      var minimumXPosition = this.width * scale;\n      var minimumYPosition = this.height * scale;\n\n      var xPrime = Math.ceil(minimumXPosition);\n      var yPrime = Math.ceil(minimumYPosition);\n\n      var newYLength = getYGivenX(this.width, this.height, xPrime);\n      var yZLength = pythagoreanTheorem(xPrime, newYLength);\n\n      var newXLength = getXGivenY(this.width, this.height, yPrime);\n      var xZLength = pythagoreanTheorem(newXLength, yPrime);\n\n      var candidate = function() {\n        if (xZLength > yZLength) {\n          return [xPrime, Math.floor(minimumYPosition)];\n        } else if (yZLength > xZLength) {\n          return [Math.floor(minimumXPosition), yPrime];\n        }\n        return [Math.ceil(minimumXPosition), Math.ceil(minimumYPosition)];\n      };\n\n      var result = candidate();\n      if (result[0] * result[1] < numberOfItems) {\n        return [xPrime, yPrime];\n      }\n      return result;\n    };\n\n    \n    return RectangleLayoutService;\n  }]);\nangular.module('troutSpotr')\n  .directive('accessPointSummaryTally', ['RectangleLayoutService', function(RectangleLayoutService) {\n    'use strict';\n    return {\n      templateUrl: 'app/ui/accessPointSummary/AccessPointSummaryTallyTemplate.html',\n      restrict: 'A',\n      link: function postLink(scope , element/*, attrs*/ ) {\n        var ROOT_CLASS = '.js-tally-root';\n        var WIDTH = 32;\n        var HEIGHT = 24;\n        \n        scope.stream.AccessPoints = _.uniq(scope.stream.AccessPoints, 'LinearOffset');\n        var troutStreamIntersections = scope.stream.AccessPoints.filter(function(i) {\n          return i.IsOverOrNearTroutStreamSection;\n        }).sort(function(a) {\n          return a.IsOverOrNearPublicLand ? -100 : 100;\n        });\n        scope.denominator = troutStreamIntersections.length;\n        var publicTroutStreamIntersections = troutStreamIntersections.filter(function(i) {\n          return i.IsOverOrNearPublicLand;\n        });\n        scope.numerator = publicTroutStreamIntersections.length;\n        scope.rows = Math.ceil(Math.sqrt(scope.denominator));\n        if (scope.rows === 0) {\n          return;\n        }\n\n        // if (scope.rows > 3) { debugger};\n\n        var generator = new RectangleLayoutService(WIDTH, HEIGHT);\n        var dimensions = generator.getBoundingBox(scope.denominator);\n        var numberOfColumns = dimensions[0];\n        var numberOfRows = dimensions[1];\n\n        var boxWidth = 4;\n\n        var widthOfContainer = numberOfColumns * boxWidth;\n        var heightOfContainer = numberOfRows * boxWidth;\n\n        var offset = [(WIDTH - widthOfContainer) * 0.5, (HEIGHT - heightOfContainer) * 0.5];\n        scope.root = d3.select(element[0]).select(ROOT_CLASS);\n        scope.container = scope.root.append('g')\n          .attr('class', 'access-points')\n          .attr('transform', 'translate(' + offset[0] + ', ' + offset[1] + ')');\n\n        scope.container.selectAll('circle')\n          .data(troutStreamIntersections)\n          .enter()\n          .append('circle')\n          .attr('data-length', scope.denominator)\n          .attr('data-width', numberOfColumns)\n          .attr('data-height', numberOfRows)\n          .attr('cx', function(d, index) {\n            var xPosition = ((index % numberOfColumns) * (boxWidth * 1.0));\n            // console.log(xPosition);\n            return xPosition;\n          })\n          .attr('cy', function(d, index) {\n            var yPosition = Math.floor(index / numberOfColumns) * (boxWidth * 1.0);\n            return yPosition;\n          })\n          .attr('r', boxWidth * 0.5)\n          .attr('class', function(d) {\n            return d.IsOverOrNearPublicLand ? 'numerator' : 'denominator';\n          });\n\n\n      }\n    };\n  }]);\nangular.module('troutSpotr')\n  .directive('accessPointSummary', [function() {\n    'use strict';\n    return {\n      templateUrl: 'app/ui/accessPointSummary/AccessPointSummaryTemplate.html',\n      restrict: 'A',\n      link: function postLink(scope /*, element, attrs*/ ) {\n        scope.stream.AccessPoints = _.uniq(scope.stream.AccessPoints, 'LinearOffset');\n        var troutStreamIntersections = scope.stream.AccessPoints.filter(function(i) {\n          return i.IsOverOrNearTroutStreamSection;\n        });\n        scope.denominator = troutStreamIntersections.length;\n        var publicTroutStreamIntersections = troutStreamIntersections.filter(function(i) {\n          return i.IsOverOrNearPublicLand;\n        });\n        scope.numerator = publicTroutStreamIntersections.length;\n      }\n    };\n  }]);\n\n/**\n * @ngdoc service\n * @name troutDashApp.TableOfContentsRepository\n * @description\n * # TableOfContentsRepository\n * Factory in the troutDashApp.\n */\nangular.module('troutSpotr')\n    .factory('TableOfContentsRepository', ['BaseApiService', 'RegionGeometryService', 'HierarchicalGeometryViewModel',\n        function(BaseApiService, RegionGeometryService, HierarchicalGeometryViewModel) {\n            'use strict';\n            var TABLE_OF_CONTENTS_CACHE_KEY = 'tableOfContents';\n            var COUNTIES_CACHE_KEY = 'counties';\n            var REGIONS_CACHE_KEY = 'regions';\n            var TableOfContentsRepository = function() {\n                BaseApiService.call(this);\n                this.logCache();\n            };\n\n            var proto = TableOfContentsRepository.prototype = Object.create(BaseApiService.prototype);\n\n            proto.bustTableOfContentsCache = function() {\n                var key = TABLE_OF_CONTENTS_CACHE_KEY;\n                this.cache.remove(TABLE_OF_CONTENTS_CACHE_KEY);\n            };\n\n            proto.getTableOfContents = function() {\n                var key = TABLE_OF_CONTENTS_CACHE_KEY;\n                if (this.cache.get(key)) {\n                    console.log('found in cache');\n                    return this.cache.get(key);\n                }\n\n                var promise = this.doCall({}, 'assets/data/tableOfContents.topo.json')\n                    .then(function(regionTopoJson) {\n                        var state = topojson.feature(regionTopoJson, regionTopoJson.objects.state);\n                        var regions = topojson.feature(regionTopoJson, regionTopoJson.objects.region);\n                        var counties = topojson.feature(regionTopoJson, regionTopoJson.objects.county);\n                        var streams = topojson.feature(regionTopoJson, regionTopoJson.objects.streamProperties);\n\n                        var stateHash = _(state.features)\n                            .map(function(feature) {\n                                var stateModel = new HierarchicalGeometryViewModel();\n                                var prop = feature.properties;\n                                stateModel.id = prop.gid;\n                                stateModel.name = prop.name;\n                                stateModel.centroidLatitude = NaN;\n                                stateModel.shortName = prop.short_name;\n                                stateModel.centroidLongitude = NaN;\n                                stateModel.parent = null;\n                                stateModel.type = 'state';\n                                stateModel.children = [];\n                                stateModel.geometry = feature;\n                                return stateModel;\n                            })\n                            .indexBy('id')\n                            .value();\n\n                        var regionHash = _(regions.features)\n                            .map(function(feature) {\n                                var regionModel = new HierarchicalGeometryViewModel();\n                                regionModel.shortName = feature.properties.name;\n                                regionModel.id = feature.properties.gid;\n                                regionModel.name = feature.properties.name;\n                                regionModel.geometry = feature;\n                                regionModel.type = 'region';\n                                return regionModel;\n                            })\n                            .sortBy('name')\n                            .indexBy('id')\n                            .value();\n\n                        var countyhash = _(counties.features)\n                            .filter(function(feature) {\n                                return feature.properties.stream_count > 0;\n                            })\n                            .map(function(feature) {\n                                var countyModel = new HierarchicalGeometryViewModel();\n                                var properties = feature.properties;\n                                countyModel.id = properties.gid;\n                                countyModel.name = properties.name;\n                                countyModel.geometry = feature;\n                                _.extend(countyModel, properties);\n                                countyModel.type = 'county';\n                                return countyModel;\n                            })\n                            .sortBy('name')\n                            .indexBy('id')\n                            .value();\n\n                        var countyByRegion = _(countyhash)\n                            .groupBy('region_id')\n                            .value();\n\n                        // TODO: Fix this nonsense.\n                        var minnesota = stateHash['49'];\n                        var regionByState = _(regionHash)\n                            .groupBy(function() {\n                                return minnesota.id;\n                            })\n                            .value();\n\n                        var streamHash = _(streams.features)\n                            .map(function(feature) {\n                                var streamModel = new HierarchicalGeometryViewModel();\n                                var properties = feature.properties;\n                                streamModel.id = properties.Id;\n                                streamModel.name = properties.Name;\n                                streamModel.geometry = feature;\n                                streamModel.centroidLongitude = properties.CentroidLongitude;\n                                streamModel.centroidLatitude = properties.CentroidLatitude;\n                                _.extend(streamModel, properties);\n                                // console.table(streamModel.AccessPoints);\n                                streamModel.type = 'streamCentroid';\n                                return streamModel;\n                            })\n                            .sortBy('name')\n                            .indexBy('id')\n                            .value();\n\n                        _.forEach(stateHash, function(state) {\n                            var stateId = state.id;\n                            var regions = regionByState[stateId];\n                            state.children = regions;\n                            // _(regions).forEach(function(r) { r.parent = state; });\n                            _.forEach(state.children, function(region) {\n                                var regionId = region.id;\n                                var counties = countyByRegion[regionId];\n                                region.children = counties;\n                                region.parent = state;\n                                _.forEach(region.children, function(c) {\n                                    c.parent = region;\n                                });\n                            });\n                        });\n\n                        // now we have to get the streams under the counties.\n                        // we have to respect the Many to Many relationship.\n                        _.forEach(streamHash, function(stream) {\n                            _.forEach(stream.Counties, function(streamCountyModel) {\n                                var countyModel = countyhash[streamCountyModel.Id];\n                                countyModel.children.push(stream);\n                                // what to do about the parent tho?\n                            });\n                        });\n\n                        this.logCache();\n                        return stateHash;\n\n                    }.bind(this));\n                this.cache.put(key, promise);\n                return promise;\n            };\n\n            TableOfContentsRepository.prototype = proto;\n            return new TableOfContentsRepository();\n        }\n    ]);\n'use strict';\n\n/**\n * @ngdoc service\n * @name troutDashApp.HierarchicalGeometryViewModel\n * @description\n * # HierarchicalGeometryViewModel\n * Factory in the troutDashApp.\n */\nangular.module('troutSpotr')\n  .factory('HierarchicalGeometryViewModel', function () {\n    function HierarchicalGeometryViewModel() {\n        this.init();\n    }\n\n    HierarchicalGeometryViewModel.prototype =  {\n      id: null,\n      name: '',\n      shortName: '',\n      geometry: null,\n      centroidLatitude: NaN,\n      centroidLongitude: NaN,\n      type: null,\n      parent: null,\n      children: [],\n\n      init: function() {\n        this.id = null;\n        this.name = '';\n        this.shortName = '';\n        this.geometry = null;\n        this.centroidLongitude = NaN;\n        this.centroidLatitude = NaN; \n        this.parent = null;\n        this.children = [];\n      }\n    };\n\n\n    return HierarchicalGeometryViewModel;\n  });\n\n'use strict';\n\n/**\n * @ngdoc service\n * @name troutDashApp.HierarchicalGeometryCollection\n * @description\n * # HierarchicalGeometryCollection\n * Factory in the troutDashApp.\n */\nangular.module('troutSpotr')\n  .factory('HierarchicalGeometryCollection', function (BaseCollection, HierarchicalGeometryViewModel) {\n    function HierarchicalGeometryCollection(data) {\n        BaseCollection.call(this, data);\n    }\n\n    /** @lends  HierarchicalGeometryCollection.prototype */\n    var proto = HierarchicalGeometryCollection.prototype = Object.create(BaseCollection.prototype);\n    HierarchicalGeometryCollection.prototype.constructor = HierarchicalGeometryCollection;\n\n    /**\n     * Constructor used to create models from JSON data\n     * @property {Function} model HierarchicalGeometryViewModel constructor function\n     */\n    proto.model = HierarchicalGeometryViewModel;\n\n    return HierarchicalGeometryCollection;\n  });\n\n'use strict';\n\n/**\n * @ngdoc service\n * @name troutDashApp.RegionRepositoryService\n * @description\n * # RegionRepositoryService\n * Factory in the troutDashApp.\n */\nangular.module('troutSpotr')\n  .factory('RegionRepositoryService', function (RegionGeometryService, TableOfContentsRepository, $q) {\n    var RegionRepositoryService = function () {\n        \n    };\n\n    var proto = {\n    \tgetRegions: function() {\n    \t\treturn TableOfContentsRepository.getTableOfContents()\n    \t\t\t.then(function(states) {\n    \t\t\t\tconsole.log('got em');\n    \t\t\t});\n    \t},\n\n    \tisCached: function(regionid) {\n            return false;\n    \t},\n\n    \tcacheRegion: function(regionId) {\n            return true;\n    \t},\n\n    \tuncacheRegion: function(regionId) {\n            return true;\n    \t},\n\n        getRegion: function(regionId) {\n            if (this.isCached()) {\n                // todo this\n            }\n\n            \n        }\n    };\n\n    RegionRepositoryService.prototype = proto;\n    return new RegionRepositoryService();\n  });\n\n'use strict';\n\nvar REGION_CACHE_KEY = 'region';\nvar createKey = function(stateId, regionId) {\n\treturn REGION_CACHE_KEY + '_' + stateId + '_' + regionId;\n};\n/**\n * @ngdoc service\n * @name troutDashApp.RegionGeometryService\n * @description\n * # RegionGeometryService\n * Factory in the troutDashApp.\n */\nangular.module('troutSpotr')\n  .factory('RegionGeometryService', ['BaseApiService', 'RegionApiService', 'HierarchicalGeometryViewModel', \n  \tfunction (BaseApiService, RegionApiService, HierarchicalGeometryViewModel) {\n    var RegionGeometryService = function () {\n        BaseApiService.call(this);\n    };\n\n    var proto = RegionGeometryService.prototype = Object.create(BaseApiService.prototype);\n\n    proto.getRegion = function(stateModel, regionModel) {\n\t\tif (stateModel == null || stateModel.shortName == null) {\n\t\t\tthrow new Error('state cannot be null');\n\t\t}\n\n\t\tif (regionModel == null || regionModel.shortName == null) {\n\t\t\tthrow new Error('region cannot be null');\n\t\t}\n\n\t\tvar stateId = stateModel.shortName;\n\t\tvar regionId = regionModel.shortName;\n\t\tvar regionKey = createKey(stateId, regionId);\n\n        if (this.cache.get(regionKey)) {\n            console.log('found in cache');\n            return this.cache.get(regionKey);\n        }\n\n\t\tvar promise = RegionApiService.getRegion(stateId, regionId)\n\t\t\t.then(function(geometry) {\n\t\t\t\tconsole.log('new geom', geometry);\n\t\t\t\treturn geometry;\n\t\t\t});\n\n        this.cache.put(regionKey, promise);\n    \treturn promise;\n\t};\n\n    RegionGeometryService.prototype = proto;\n    return new RegionGeometryService();\n  }]);\n\n'use strict';\nvar createPath = function(stateId, regionId) {\n  return stateId + '/' + regionId + '.topo.json';\n};\n/**\n * @ngdoc service\n * @name troutDashApp.RegionApiService\n * @description\n * # RegionApiService\n * Factory in the troutDashApp.\n */\nangular.module('troutSpotr')\n  .factory('RegionApiService', ['BaseApiService', function(BaseApiService) {\n    var RegionApiService = function() {\n      BaseApiService.call(this);\n      this.logCache();\n    };\n\n    var proto = RegionApiService.prototype = Object.create(BaseApiService.prototype);\n\n    proto.getRegion = function(stateId, regionId) {\n      if (stateId == null) {\n        throw new Error('stateId cannot be null');\n      }\n\n      if (regionId == null) {\n        throw new Error('regionId cannot be null');\n      }\n\n      var path = createPath(stateId, regionId);\n      return this.doCall({}, 'assets/data/' + path);\n    };\n\n    RegionApiService.prototype = proto;\n    return new RegionApiService();\n  }]);\n'use strict';\n\n/**\n * @ngdoc service\n * @name troutDashApp.StreamRatioViewModel\n * @description\n * # StreamRatioViewModel\n * Factory in the troutDashApp.\n */\nangular.module('troutSpotr')\n  .factory('StreamRatioViewModel', function () {\n        var StreamRatioViewModel = function(totalLength, publicLandLength) {\n            this.totalLength = 0;\n            this.publicLandLength = 0;\n            this.init(totalLength, publicLandLength);\n        };\n\n        var proto = StreamRatioViewModel.prototype;\n\n        proto.init = function(totalLength, publicLandLength) {\n            if (totalLength == null || publicLandLength < 0) {\n                throw new Error('totalLength cannot be null or less than 0');\n            }\n\n            if (publicLandLength == null || publicLandLength < 0) {\n                throw new Error('publicLength cannot be null or less than 0');\n            }\n\n            if (publicLandLength > totalLength) {\n                // clamp - technically this can be true, given the fact\n                // that a stream can have easement and not be a trout stream section.\n                // BUG: Currently we're computing how much is on trout streams.\n\n                publicLandLength = totalLength;\n            }\n\n            this.totalLength = totalLength;\n            this.publicLandLength = publicLandLength;\n\n            var computeRadiusFromLength = function(length) {\n                var area = Math.sqrt(length / Math.PI);\n                return area;\n            };\n\n            this.waterRadius = computeRadiusFromLength(this.totalLength);\n            // LIE about the width.\n           \t// use the diameter of the water ratio to determine how large\n           \tvar publicLandLengthTOWaterLengthRatio = this.publicLandLength / this.totalLength;\n            this.publicLandRadius = this.waterRadius * publicLandLengthTOWaterLengthRatio;\n        };\n\n        return StreamRatioViewModel;\n  });\n\n'use strict';\n\n/**\n * @ngdoc service\n * @name troutDashApp.StreamApiService\n * @description\n * # StreamApiService\n * Factory in the troutDashApp.\n */\nangular.module('troutSpotr')\n  .factory('StreamApiService', ['$rootScope', '$cacheFactory', '$http', '$q', '$timeout',\n    function($rootScope, $cacheFactory, $http, $q, $timeout) {\n      function StreamApiService() {\n\n      }\n\n      StreamApiService.prototype = {\n        getStreams: function() {\n          var deferred = $q.defer();\n\n          $timeout(function() {\n            var gettingData = $http.get('./data/trout-dash-minnesota.json')\n              .then(function(response) {\n                return response.data;\n              });\n\n            deferred.resolve(gettingData);\n          }, 1000);\n\n          return deferred.promise;\n        },\n\n        getRegions: function() {\n          // return $http.get('./data/regionDetails.json')\n          //   .then(function(response) {\n          //     return response.data;\n          //   });\n\n          var deferred = $q.defer();\n\n          $timeout(function() {\n            var gettingData = $http.get('./data/regionDetails.json')\n              .then(function(response) {\n                return response.data;\n              });\n\n            deferred.resolve(gettingData);\n          }, 1000);\n\n          return deferred.promise;\n        }\n      };\n\n      return new StreamApiService();\n    }\n  ]);\n'use strict';\n\n/**\n * @ngdoc service\n * @name troutDashApp.LinearReferenceViewModel\n * @description\n * # LinearReferenceViewModel\n * Factory in the troutDashApp.\n */\nangular.module('troutSpotr')\n  .factory('LinearReferenceViewModel', function () {\n    var StreamLineViewModel = function (lineSegment, inverseLength) {\n        this.lineSegment = null;\n        this.xOffset = 0.0;\n        this.width = 0.0;\n        this.init(lineSegment, inverseLength);\n    };\n\n    StreamLineViewModel.prototype.init = function(lineSegment, inverseLength) {\n      this.lineSegment = lineSegment;\n      var stop = lineSegment.Stop * inverseLength;\n      var start = lineSegment.Start * inverseLength;\n      this.xOffset = 1.0 - stop;\n      this.width = Math.abs(stop - start);\n    };\n\n    return StreamLineViewModel;\n  });\n\n'use strict';\n\n/**\n * @ngdoc service\n * @name troutDashApp.GeometryApiService\n * @description\n * # GeometryApiService\n * Factory in the troutDashApp.\n */\nangular.module('troutSpotr')\n  .factory('GeometryApiService', ['$rootScope', '$cacheFactory', '$http', '$q', '$timeout',\n    function ($rootScope, $cacheFactory, $http, $q, $timeout) {\n    function GeometryApiService() {\n\n    }\n\n    GeometryApiService.prototype = {\n      getRegionGeometries: function() {\n        var deferred = $q.defer();\n\n          $timeout(function() {\n            var gettingData = $http.get('./data/regionGeometry.json')\n            .then(function(response) {\n              return response.data;\n            });\n\n            deferred.resolve(gettingData);\n          }, 1000);\n\n          return deferred.promise;\n      }\n    };\n\n    return new GeometryApiService();\n  }]);\n\n'use strict';\n\n/**\n * @ngdoc service\n * @name troutDashApp.BaseModel\n * @description\n * # BaseModel\n * Factory in the troutDashApp.\n */\nangular.module('troutSpotr')\n  .factory('BaseModel', function () {\n    function BaseModel(json) {\n        if (json) {\n            this._fromJSON(json);\n        }\n    }\n\n    /** @lends  BaseModel.prototype */\n    BaseModel.prototype = {\n        constructor: BaseModel,\n        /**\n         * Merges properties from a POJO into the model\n         * @param  {Object} json raw data\n         */\n        _fromJSON: function(json) {\n            var key;\n            for (key in json) {\n                if (json.hasOwnProperty(key)) {\n                    this[key] = json[key];\n                }\n            }\n        },\n\n        /**\n         * Returns an object hash of the model properties\n         * @return {Object}\n         */\n        toJSON: function() {\n            var hash = {};\n            var key;\n            for (key in this) {\n                if (this.hasOwnProperty(key) && typeof this[key] !== 'function') {\n                    hash[key] = this[key];\n                }\n            }\n\n            return hash;\n        },\n\n        destroy: function() {\n            var key;\n            for (key in this) {\n                if (this.hasOwnProperty(key)) {\n                    delete this[key];\n                }\n            }\n        }\n    };\n\n    BaseModel.generateIdomaticName = function(model) {\n        return model.type;\n    };\n\n    return BaseModel;\n  });\n\n'use strict';\n\n/**\n * @ngdoc service\n * @name troutDashApp.BaseCollection\n * @description\n * # BaseCollection\n * Factory in the troutDashApp.\n */\nangular.module('troutSpotr')\n  .factory('BaseCollection', function (BaseModel) {\n    function BaseCollection(udefOrArray) {\n        this._models = [];\n        if (udefOrArray) {\n            this._addAll(udefOrArray);\n        }\n    }\n\n    /** @lends BaseCollection.prototype */\n    BaseCollection.prototype = {\n\n        /**\n         * @property {Function} model BaseModel constructor function, used to convert raw JSON into models\n         */\n        model: BaseModel,\n        constructor: BaseCollection,\n\n        /**\n         * @property {BaseModel[]} _models Reference store for model instances\n         */\n        _models: null,\n\n        /**\n         * @property {Number} Number of models in the colleciton\n         */\n        length: 0,\n\n        /**\n         * @method\n         * @return {Object[]} Array of POJO model data\n         */\n        toJSON: function() {\n            return this.map(function(model) {\n                return model.toJSON();\n            });\n        },\n\n        toArray: function() {\n            return this._models.slice();\n        },\n\n        destroy: function() {\n            this.each(function(model) {\n                model.destroy();\n            });\n            this._models.length = 0;\n            this._models = null;\n        },\n\n        /**\n         * @method\n         * @param {BaseModel[]|null} arrayOrUndefined Returns a new instance of BaseCollection.\n         * @return {BaseCollection} Returns a copy of the collection. If an array of BaseModels are passed, only those\n         *                          models are included. Otherwise, the full collection is copied.\n         */\n        copy: function(arrayOrUndefined) {\n            if (arrayOrUndefined) {\n                return new this.constructor(arrayOrUndefined);\n            }\n\n            return new this.constructor(this._models);\n        },\n\n        /**\n         * @method\n         * @param {Object[]|BaseModel[]} modelData Convenience method for adding many models.  Iterates and calls #add\n         * @see add\n         */\n        _addAll: function(modelData) {\n            var i;\n            var len = modelData.length;\n            for (i = 0; i < len; i++) {\n                this.add(modelData[i]);\n            }\n        },\n\n        /**\n         * Adds a model to the collection.  If type Object is passed, it gets passed to new {this.model} first\n         * @method\n         * @param {Object|BaseModel} modelData Model data to add\n         */\n        add: function(modelData) {\n            var instanceModel;\n            if (!(modelData instanceof this.model)) {\n                instanceModel = new this.model(modelData);\n            } else {\n                instanceModel = modelData;\n            }\n\n            this._models.push(instanceModel);\n            this.length++;\n            return this.length;\n        },\n\n        /**\n         * Remove a model from the collection.  Delegates to _removeByModel or _removeByModelId based on the parameter\n         * @method\n         * @param {BaseModel|Number} modelDataOrId Model instance or model id value\n         * @return {Number} Length of the collection after attempting to remove the model\n         */\n        remove: function(modelDataOrId) {\n            var model;\n            // avoid concurrency bug\n            var referenceToModelOrId = modelDataOrId;\n            if (referenceToModelOrId instanceof this.model) {\n                model = this._removeByModel(referenceToModelOrId);\n            } else {\n                model = this._removeById(referenceToModelOrId);\n            }\n\n            if (model && model !== -1) {\n                this.length--;\n            }\n\n            return this.length;\n        },\n\n        /**\n         * Remove all elements from the collection and reset its length to 0\n         * @method\n         */\n        empty: function() {\n            this._models.length = 0;\n            this.length = 0;\n        },\n\n        /**\n         * Return the first element from the collection\n         * Especially useful for creating non-queue based pools\n         * @return {BaseModel|undefined}\n         */\n        first: function() {\n            return this._models[0];\n        },\n\n        /**\n         * Applies browser-standard sorting via Array.prototype.sort to _models\n         * @method\n         * @param {Function} sortFn Sorting function to use\n         */\n        sort: function(sortFn) {\n            this._models.sort(sortFn);\n        },\n\n        /**\n         * Applies browser-standard sorting via Array.prototype.sort to _models.  Directly compares model keys\n         * @method\n         * @param {String} key      Model key to sort by\n         * @param {Boolean|Undefined} sortDesc If true, sorts by descending order\n         */\n        sortBy: function(key, sortDesc) {\n            this.sort(function(modelA, modelB) {\n                var a = modelA[key];\n                var b = modelB[key];\n\n                if (sortDesc) {\n                    return a > b ? -1 : a < b ? 1 : 0;\n                } else {\n                    return a < b ? -1 : a > b ? 1 : 0;\n                }\n            });\n        },\n\n        /**\n         * Strategy method for browser-standard sorting via Array.prototype.sort to _models. Delegates sorting to a\n         * private method based on the type parameter\n         * @method\n         * @param {String} key      Model key to sort by\n         * @param {Boolean|Undefined} sortDesc If true, sorts by descending order\n         * @param {BaseCollection.SORT.TYPE} type Sorting method is delegated by the type value\n         */\n        sortByType: function(key, sortDesc, type) {\n            if (type === 'string') {\n                this.sortByString(key, sortDesc, true);\n            } else if (type === 'arrayLength') {\n                this.sortByCount(key, sortDesc);\n            } else if (type === 'number') {\n                this.sortByNumber(key, sortDesc);\n            } else {\n                this.sortBy(key, sortDesc);\n            }\n        },\n\n        /**\n         * Strategy method for browser-standard sorting via Array.prototype.sort to _models. Key must be a model\n         * property of type String.\n         * Default sort is ascii order, unless useLowercase is true\n         * @method\n         * @param {String} key      Model key to sort by\n         * @param {Boolean|Undefined} sortDesc If true, sorts by descending order\n         * @param {Boolean} [type=false] Use alphabetical instead of ascii\n         */\n        sortByString: function(key, sortDesc, useLowercase) {\n            this.sort(function(modelA, modelB) {\n                var a = modelA[key];\n                var b = modelB[key];\n\n                if (useLowercase) {\n                    a = a.toLowerCase();\n                    b = b.toLowerCase();\n                }\n\n                if (sortDesc) {\n                    return a > b ? -1 : a < b ? 1 : 0;\n                } else {\n                    return a < b ? -1 : a > b ? 1 : 0;\n                }\n            });\n        },\n\n        /**\n         * Strategy method for browser-standard sorting via Array.prototype.sort to _models. Key must be a model\n         * property of type Array.\n         * Default sort is ascending order, unless sortDesc is true\n         * @method\n         * @param {String} key      Model key to sort by\n         * @param {Boolean|Undefined} sortDesc If true, sorts by descending order\n         * @param {Boolean} [type=false] Use descending or ascending order (ascending is default)\n         */\n        sortByCount: function(key, sortDesc) {\n            this.sort(function(modelA, modelB) {\n                var a = modelA[key] ? modelA[key].length : 0;\n                var b = modelB[key] ? modelB[key].length : 0;\n\n                if (sortDesc) {\n                    return a > b ? -1 : a < b ? 1 : 0;\n                } else {\n                    return a < b ? -1 : a > b ? 1 : 0;\n                }\n            });\n        },\n\n         /**\n         * Strategy method for browser-standard sorting via Array.prototype.sort to _models. Key must be a model\n         * property of type Array.\n         * Default sort is ascending order, unless sortDesc is true\n         * @method\n         * @param {String} key      Model key to sort by\n         * @param {Boolean|Undefined} sortDesc If true, sorts by descending order\n         * @param {Boolean} [type=false] Use descending or ascending order (ascending is default)\n         */\n        sortByNumber: function(key, sortDesc) {\n            this.sort(function(modelA, modelB) {\n                var a = modelA[key] ? modelA[key] : 0;\n                var b = modelB[key] ? modelB[key] : 0;\n\n                if (sortDesc) {\n                    return a > b ? -1 : a < b ? 1 : 0;\n                } else {\n                    return a < b ? -1 : a > b ? 1 : 0;\n                }\n            });\n        },\n\n        /**\n         * @method\n         * @param  {Number|String} id ID of the model to return\n         * @return {BaseModel}    Found model\n         */\n        get: function(id) {\n            var i = 0;\n            var len = this._models.length;\n            for (; i < len; i++) {\n                // Some server IDs are BIGINT (strings), others are numbers. However, all are auto-incremented, so\n                // 0 is never a valid identifier and type coersion is both acceptable and necessary in this case.\n                /* jshint eqeqeq:false */\n                if (this._models[i].id == id) {\n                    return this._models[i];\n                }\n            }\n        },\n\n        /**\n         * Return the model at the given index.  Appropriate only when .each is not acceptable (i.e. in a for loop)\n         * @param  {Integer} index index of the model\n         * @return {BaseModel}\n         */\n        at: function(index) {\n            return this._models[index];\n        },\n\n        /**\n         * @method\n         * @param  {Number} pageNumber Starting index of models to return\n         * @param  {Number} perPage    Range length of models to return\n         * @return {BaseModel[]}       Array of models starting at pageNumber up to but not including pageNumber+perPage\n         */\n        getPage: function(pageNumber, perPage) {\n            var startIndex = perPage * (pageNumber - 1);\n            var endIndex = startIndex + perPage;\n\n            if (startIndex > this._models.length - 1) {\n                return [];\n            }\n\n            return this._models.slice(startIndex, endIndex);\n        },\n\n        contains: function(id) {\n            var i;\n            var len = this.length;\n            for (i = 0; i < len; i++) {\n                if (this._models[i].id === id) {\n                    return true;\n                }\n            }\n            return false;\n        },\n\n        /**\n         * Compare this collection to another, then\n         *   remove and add items individually until the two match\n         * @param otherCollection {BaseCollection}\n         *   A collection of the same type as `this`\n         * @return {Object<Array<?>>}\n         *   A diff representing the changes made to this object. Example:\n         *   - this collection's IDs: [1, 2, 3, 4, 5]\n         *   - other collection's IDs: [4, 5, 6, 7]\n         *   - after merge, this collection's IDs: [4, 5, 6, 7]\n         *   - return value: {removed: [1, 2, 3], added: [6, 7]}\n         */\n        merge: function(otherCollection) {\n            var self;\n            var removed; \n            var added;\n\n            // Ignore collections of different types\n            if (this.constructor !== otherCollection.constructor) {\n                return []; // exit early\n            }\n\n            self = this;\n            removed = [];\n            added = [];\n\n            // Remove models\n            this.each(function(element, index) {\n                if (!otherCollection.contains(element.id)) {\n                    this.remove(element.id);\n                    removed.push(element.id);\n                }\n            });\n\n            // Add model objects\n            otherCollection.each(function(element, index) {\n                if (!this.contains(element.id)) {\n                    this.add(element);\n                    added.push(element.id);\n                }\n            });\n\n            return {\n                'removed': removed,\n                'added': added\n            };\n\n        },\n\n        /**\n         * @method\n         * @param  {Number} id ID of model to remove\n         * @return {BaseModel|Number} Model removed, or -1 if model not found\n         */\n        _removeById: function(id) {\n            var len = this.length;\n            var i;\n\n            for (i = 0; i < len; i++) {\n                if (this._models[i].id === id) {\n                    return this._models.splice(i, 1);\n                }\n            }\n        },\n\n        /**\n         * @method\n         * @param  {BaseModel} Model to remove\n         * @return {BaseModel|Number} Model removed, or -1 if model not found\n         */\n        _removeByModel: function(model) {\n            var len = this.length;\n            var i;\n\n            for(i = 0; i < len; i++) {\n                if (this._models[i] === model) {\n                    return this._models.splice(i, 1);\n                }\n            }\n        }\n    };\n\n    // Borrowed from Backbone\n    // @see http://backbonejs.org/docs/backbone.html\n    var methods = [\n        'forEach',\n        'each',\n        'map',\n        'reduce',\n        'find',\n        'filter',\n        'indexOf'\n    ];\n\n    _.each(methods, function(method) {\n        BaseCollection.prototype[method] = function() {\n            var args = Array.prototype.slice.call(arguments);\n            args.unshift(this._models);\n            return _[method].apply(_, args);\n        };\n    });\n\n    /**\n     * Sorting constants\n     * @memberOf BaseCollection\n     * @constant\n     */\n    BaseCollection.SORT = {\n        /** @enum Sorting types */\n        TYPE: {\n            ARRAY_LENGTH: 'arrayLength',\n            STRING: 'string',\n            DATE: 'date',\n            NUMBER: 'number'\n        }\n    };\n\n    return BaseCollection;\n  });\n\n'use strict';\n\n/**\n * @ngdoc service\n * @name troutDashApp.BaseApiService\n * @description\n * # BaseApiService\n * Factory in the troutDashApp.\n */\n\n\n\nangular.module('troutSpotr')\n  .factory('BaseApiService', ['$rootScope', '$cacheFactory', '$http', '$q', '$timeout',\n    function ($rootScope, $cacheFactory, $http, $q, $timeout) {\n    var sessionStorage = window.sessionStorage;\n    var DEBUGGER_LATENCY = 800;\n    var globalCache = $cacheFactory('du');\n\n    function BaseApiService() {\n        this.cache = globalCache;\n    }\n\n    BaseApiService.prototype = {\n      cache: null,\n      resetCache: function() {\n          globalCache.removeAll();\n      },\n\n      logCache: function() {\n        var info = this.cache.info();\n        console.log('cache', info);\n      },\n\n      doCall: function(data, endpoint, cache) {\n        cache = false;\n\n        var config = {\n            url: BaseApiService.API_BASE_PATH + endpoint,\n            params: data,\n            cache: cache,\n            method: 'GET'\n        };\n\n        var deferred = $q.defer();\n\n          $timeout(function() {\n            var gettingData = $http(config)\n              .then(function(response) {\n                  if (response && response.data && response.data.exceptionType) {\n                      return $q.reject(response.data);\n                  }\n\n                  return response.data;\n              }).catch(function(reason) {\n                  // perform some operation here if need be...\n                  return $q.reject(reason);\n              });\n\n            deferred.resolve(gettingData);\n          }, DEBUGGER_LATENCY);\n\n          return deferred.promise;\n      }\n    };\n\n    BaseApiService.API_BASE_PATH = '';\n\n    return BaseApiService;\n  }]);\n\n(function() {\n  'use strict';\n\n  angular\n    .module('troutSpotr')\n    .run(runBlock);\n\n  /** @ngInject */\n  function runBlock($log) {\n\n    $log.debug('runBlock end');\n  }\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('troutSpotr')\n    .config(routerConfig);\n\n  /** @ngInject */\n  function routerConfig($stateProvider, $urlRouterProvider) {\n    $stateProvider\n      .state('home', {\n        url: '/',\n        templateUrl: 'app/ui/main/main.html',\n        controller: 'MainController',\n        controllerAs: 'main'\n      });\n\n    $urlRouterProvider.otherwise('/');\n  }\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('troutSpotr');\n    // .constant('malarkey', malarkey)\n    // .constant('moment', moment);\n\n})();\n\n(function() {\n  'use strict';\n\n  angular\n    .module('troutSpotr')\n    .config(config);\n\n  /** @ngInject */\n  function config($logProvider) {\n    // Enable log\n    $logProvider.debugEnabled(true);\n  }\n\n})();\n\nangular.module(\"troutSpotr\").run([\"$templateCache\", function($templateCache) {$templateCache.put(\"app/ui/accessPointSummary/AccessPointSummaryTallyTemplate.html\",\"<svg class=\\\"js-tally-root access-point\\\" version=\\\"1.1\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" xmlns:xlink=\\\"http://www.w3.org/1999/xlink\\\" width=\\\"100%\\\" height=\\\"100%\\\" viewbox=\\\"0 0 32 24\\\"></svg>\");\n$templateCache.put(\"app/ui/accessPointSummary/AccessPointSummaryTemplate.html\",\"<span class=\\\"access-point\\\"><span data-ng-class=\\\"{\\'hide\\': numerator === 0}\\\" class=\\\"numerator\\\">{{::numerator}}:</span><span class=\\\"denominator\\\">{{::denominator}}</span></span>\");\n$templateCache.put(\"app/ui/main/main.html\",\"<div class=\\\"container\\\"><div data-mini-map-directive=\\\"\\\"></div><div data-stream-list=\\\"\\\"></div></div>\");\n$templateCache.put(\"app/ui/miniMap/minimaptemplate.html\",\"<div class=\\\"somethingContainer\\\" data-ng-class=\\\"{\\'somethingContainer-major\\': minimapState.isMacro}\\\"><div class=\\\"js-mini-map something\\\"></div></div>\");\n$templateCache.put(\"app/ui/restrictions/restrictionlegendtemplate.html\",\"<div class=\\\"sectionTitle\\\"><span class=\\\"icon icon_half-wide\\\"></span> Restrictions</div><ul class=\\\"restrictions\\\" data-ng-repeat=\\\"restriction in stream.Restrictions\\\"><li><div class=\\\"media\\\"><div class=\\\"icon icon_half-wide media-hd\\\"><div class=\\\"legend\\\" data-ng-class=\\\"{\\'stream-line_restriction\\': $index === 0, \\'stream-line_restriction_secondary\\': $index === 1}\\\"></div></div><span class=\\\"media-bd heading\\\">{{restriction.FullText}}</span></div></li></ul>\");\n$templateCache.put(\"app/ui/restrictions/streamrestrictiontemplate.html\",\"<div class=\\\"title\\\">Restrictions</div><ul class=\\\"restrictions\\\" data-ng-repeat=\\\"restriction in restrictionViewModel.restrictions\\\"><li><div class=\\\"media\\\"><div class=\\\"media-hd legend {{restriction.cssClass}}\\\"></div><span class=\\\"media-bd heading\\\">{{restriction.text}}</span></div></li></ul>\");\n$templateCache.put(\"app/ui/speciesSummary/speciessummarytemplate.html\",\"<span class=\\\"icon\\\"><svg preserveaspectratio=\\\"xMidYMid meet\\\" width=\\\"100%\\\" height=\\\"100%\\\" viewbox=\\\"0 0 100 100\\\" version=\\\"1.1\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" class=\\\"species\\\"><g><g class=\\\"species brown\\\" transform=\\\"translate(20, 00) scale(.5)\\\"><path xmlns=\\\"http://www.w3.org/2000/svg\\\" d=\\\"M94.369,34.554c0,0-0.174-0.02-0.43-0.02c-1.686,0-7.945,0.792-18.173,10.874 C65.963,36.731,54.145,31.36,38.322,31.36c-15.586,0-30.3,6.515-33.395,17.921l-0.095,0.481c-0.019,0.1-0.014,0.201,0.015,0.297 l0.14,0.461C8.016,62.036,22.583,68.64,37.98,68.64c15.705,0,28.01-5.539,37.754-14.146c11.646,11.496,18.184,11.668,18.459,11.669 c0.175-0.017,0.414-0.064,0.532-0.181C94.844,65.864,95,65.705,95,65.54V35.17C95,34.861,94.676,34.598,94.369,34.554z\\\" class=\\\"population\\\" data-is-populated=\\\"{{::stream.HasBrownTrout}}\\\" data-ng-class=\\\"{\\'none\\': stream.HasBrownTrout === false}\\\"></path></g><g class=\\\"species brook\\\" transform=\\\"translate(20, 30) scale(.5)\\\"><path xmlns=\\\"http://www.w3.org/2000/svg\\\" d=\\\"M94.369,34.554c0,0-0.174-0.02-0.43-0.02c-1.686,0-7.945,0.792-18.173,10.874 C65.963,36.731,54.145,31.36,38.322,31.36c-15.586,0-30.3,6.515-33.395,17.921l-0.095,0.481c-0.019,0.1-0.014,0.201,0.015,0.297 l0.14,0.461C8.016,62.036,22.583,68.64,37.98,68.64c15.705,0,28.01-5.539,37.754-14.146c11.646,11.496,18.184,11.668,18.459,11.669 c0.175-0.017,0.414-0.064,0.532-0.181C94.844,65.864,95,65.705,95,65.54V35.17C95,34.861,94.676,34.598,94.369,34.554z\\\" class=\\\"population\\\" data-is-populated=\\\"{{::stream.HasBrookTrout}}\\\" data-ng-class=\\\"{\\'none\\': stream.HasBrookTrout === false}\\\"></path></g><g class=\\\"species rainbow\\\" transform=\\\"translate(20, 60) scale(.5)\\\"><path xmlns=\\\"http://www.w3.org/2000/svg\\\" d=\\\"M94.369,34.554c0,0-0.174-0.02-0.43-0.02c-1.686,0-7.945,0.792-18.173,10.874 C65.963,36.731,54.145,31.36,38.322,31.36c-15.586,0-30.3,6.515-33.395,17.921l-0.095,0.481c-0.019,0.1-0.014,0.201,0.015,0.297 l0.14,0.461C8.016,62.036,22.583,68.64,37.98,68.64c15.705,0,28.01-5.539,37.754-14.146c11.646,11.496,18.184,11.668,18.459,11.669 c0.175-0.017,0.414-0.064,0.532-0.181C94.844,65.864,95,65.705,95,65.54V35.17C95,34.861,94.676,34.598,94.369,34.554z\\\" class=\\\"population\\\" data-is-populated=\\\"{{::stream.HasRainbowTrout}}\\\" data-ng-class=\\\"{\\'none\\': stream.HasRainbowTrout === false}\\\"></path></g></g></svg></span>\");\n$templateCache.put(\"app/ui/streamLine/streamlinetemplate.html\",\"<div class=\\\"js-stream-line\\\"></div>\");\n$templateCache.put(\"app/ui/streamList/streamlisttemplate.html\",\"<div data-ng-cloak=\\\"\\\" id=\\\"js-list-container\\\"><div data-ng-repeat=\\\"region in mapState.selectedRegion | limitTo:1 | orderBy:\\'name\\'\\\" id=\\\"{{::getRegionId(region)}}\\\" data-region-header=\\\"\\\"></div></div>\");\n$templateCache.put(\"app/ui/streamRatio/streamratiotemplate.html\",\"<svg class=\\\"stream-ratio\\\" preserveaspectratio=\\\"xMidYMid meet\\\" width=\\\"100%\\\" height=\\\"100%\\\" viewbox=\\\"0 0 16 16\\\" version=\\\"1.1\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\"><g class=\\\"stream-line_route\\\"><circle cx=\\\"8\\\" cy=\\\"8\\\" ng-attr-r=\\\"{{::streamRatio.waterRadius * 2.2}}\\\"></circle></g><g class=\\\"stream-ratio_public-land\\\"><circle cx=\\\"8\\\" cy=\\\"8\\\" ng-attr-r=\\\"{{::streamRatio.publicLandRadius * 2.2}}\\\"></circle></g></svg>\");\n$templateCache.put(\"app/ui/streamList/county/CountyHeaderTemplate.html\",\"<div fsm-sticky-header=\\\"\\\" scroll-body=\\\"getCountyScrollBodyId(county)\\\" scroll-stop=\\\"23\\\" scroll-object=\\\"county\\\" z-index-override=\\\"10000\\\" class=\\\"sectionTitle region-header\\\">{{::county.name}} Co.</div><div ng-class-odd=\\\"\\'box\\'\\\" ng-class-even=\\\"\\'box box-secondary\\'\\\" data-ng-repeat=\\\"stream in county.children | orderBy : \\'-PalsLength\\' track by stream.id\\\"><div data-stream-list-item-directive=\\\"\\\"></div></div>\");\n$templateCache.put(\"app/ui/streamList/region/RegionHeaderTemplate.html\",\"<div id=\\\"region-hdr_{{region.id}}\\\" fsm-sticky-header=\\\"\\\" scroll-body=\\\"getRegionScrollBodyId(region)\\\" scroll-stop=\\\"0\\\" scroll-object=\\\"region\\\" z-index-override=\\\"10100\\\" class=\\\"sectionTitle region-header\\\">{{::region.name}}</div><div data-ng-repeat=\\\"county in region.children | orderBy: \\'name\\' track by county.id\\\" id=\\\"{{::getCountyId(county)}}\\\" data-count-name=\\\"{{::county.name}}\\\" data-county-header=\\\"\\\"></div>\");\n$templateCache.put(\"app/ui/streamList/streamListItem/StreamListItemHeaderTemplate.html\",\"<div class=\\\"header-container\\\"><div data-ng-click=\\\"expand()\\\" class=\\\"primary\\\"><span><span data-stream-ratio=\\\"\\\" class=\\\"icon\\\"></span> <span class=\\\"title\\\">{{::stream.Name}}</span></span></div><div class=\\\"details header-container\\\"><div class=\\\"icon\\\"><div data-species-summary=\\\"\\\"></div></div><div class=\\\"icon\\\"><div data-access-point-summary-tally=\\\"\\\"></div></div><div class=\\\"icon\\\"><div data-ng-if=\\\"stream.Restrictions.length > 0\\\"><svg class=\\\"alert\\\" version=\\\"1.1\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" xmlns:xlink=\\\"http://www.w3.org/1999/xlink\\\" width=\\\"40%\\\" height=\\\"40%\\\" viewbox=\\\"0 0 32 32\\\"><path d=\\\"M31.858 27.675c-3.196-5.42-11.116-18.857-14.395-24.42-0.987-1.672-1.947-1.641-2.859-0.096-3.223 5.464-11.137 18.878-14.395 24.402-0.004 0.006-0.87 2.439 0.954 2.439h29.561c1.969 0 1.048-2.471 1.134-2.325z\\\"></path><text class=\\\"alert-text\\\" x=\\\"12\\\" y=\\\"25\\\" font-family=\\\"Futura\\\" font-size=\\\"24\\\">!</text></svg></div></div></div></div>\");\n$templateCache.put(\"app/ui/streamList/streamListItem/streamlistitemtemplate.html\",\"<div class=\\\"stream-list-item\\\" data-stream-id=\\\"{{::stream.Id}}\\\"><div><div data-stream-list-item-header=\\\"\\\"></div><div data-ng-if=\\\"isSmall === false\\\"><div class=\\\"containerBody grid-row\\\"><div class=\\\"grid-row-col_12of12\\\" data-stream-line=\\\"\\\"></div></div><div class=\\\"grid-row\\\"><div class=\\\"grid-row-col grid-row-col_9of12 media_list\\\"><div data-ng-if=\\\"stream.Restrictions.length > 0\\\" data-restriction-legend=\\\"\\\"></div><div class=\\\"sectionTitle\\\"><span class=\\\"icon icon_half-wide\\\"></span>Access Points</div><div data-ng-repeat=\\\"accessPoint in stream.AccessPoints | orderBy:\\'LinearOffset\\':true\\\"><span class=\\\"roadIntersectionIndicator\\\" data-ng-class=\\\"{\\'roadIntersectionIndicator_public\\': accessPoint.IsOverOrNearPublicLand}\\\"></span> <span class=\\\"roadIntersectionIndicator troutStreamIntersection\\\" data-ng-class=\\\"{\\'troutStreamIntersection_none\\': accessPoint.IsOverOrNearTroutStreamSection === false}\\\"></span> <span>{{::accessPoint.LinearOffset | number:2}}</span> <a class=\\\"heading intersection\\\" target=\\\"_blank\\\" href=\\\"https://www.google.com/maps/@{{accessPoint.Latitude}},{{accessPoint.Longitude}},17z\\\">{{::accessPoint.Name}}</a></div></div><div class=\\\"grid-row-col grid-row-col_3of12\\\"><div data-stream-ratio-text=\\\"\\\"></div></div></div></div></div></div>\");}]);"],"sourceRoot":"/source/"}